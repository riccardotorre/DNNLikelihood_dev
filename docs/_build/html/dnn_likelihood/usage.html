

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; DNNLikelihood</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.2/gh-fork-ribbon.min.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class" href="class.html" />
    <link rel="prev" title="DNNLik object" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> DNNLikelihood
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../code.html">Python module</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../summary.html">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../histfactory/index.html">Histfactory object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../likelihood/index.html">Lik object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sampler/index.html">Sampler object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">Data object</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">DNNLik object</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="class.html">Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dnn_likelihood_ensemble/index.html">DnnLikEnsemble object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/index.html">Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../others.html">Others</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notes.html">Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common.html">Common</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../citations.html">Use and Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices_tables.html">Indices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DNNLikelihood</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../code.html">Python module</a> &raquo;</li>
        
          <li><a href="index.html">DNNLik object</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dnn_likelihood/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="usage">
<span id="dnnlik-usage"></span><h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h1>
<p>We give here a brief introduction to the use of the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> class. Refer to the
full class documentation for more details. All examples will be referred to the toy likelihood introduced in
<a class="reference internal" href="../likelihood/usage.html#likelihood-usage"><span class="std std-ref">the Likelihood object Usage</span></a> section of the documentation.</p>
<p>A <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is defined through a series of dictionaries (or lists of dictionaries) describing data and
DNN inputs, optimizer, compilation, callbacks, and training parameters.
An example of the dictionaries defining the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> configurations is given by
(the example is designed to be representative and to show most of the input possibilities even though it does
not represent a “meaningful” choice of model and hyperparameters).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_data_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;npoints&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
                 <span class="s2">&quot;scalerX&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="s2">&quot;scalerY&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="s2">&quot;weighted&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="n">model_define_inputs</span> <span class="o">=</span> <span class="n">model_define_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hidden_layers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dense(1000,activation=&#39;relu&#39;,kernel_initializer=&#39;glorot_uniform&#39;,kernel_regularizer=regularizers.L1L2(l1=0.001, l2=0.001))&quot;</span><span class="p">,</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dense&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span><span class="c1">#{&quot;units&quot;: 1000},</span>
                                                                <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                                                           <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;GlorotUniform(seed=None)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;kernel_regularizer&quot;</span><span class="p">:</span> <span class="s2">&quot;L1L2(l1=0.001, l2=0.001)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;bias_regularizer&quot;</span><span class="p">:</span> <span class="s2">&quot;L1(l1=0.0001)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;activity_regularizer&quot;</span><span class="p">:</span> <span class="s2">&quot;L1(l1=0.0001)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;kernel_constraint&quot;</span><span class="p">:</span> <span class="s2">&quot;MaxNorm(max_value=2, axis=0)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;bias_constraint&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span>
                                                               <span class="s2">&quot;Dense(500)&quot;</span><span class="p">,</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Activation&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;relu&quot;</span><span class="p">]},</span>
                                                               <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="s2">&quot;selu&quot;</span><span class="p">],</span>
                                                               <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="s2">&quot;relu&quot;</span><span class="p">,</span><span class="s2">&quot;glorot_uniform&quot;</span><span class="p">],</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dense&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span><span class="c1">#{&quot;units&quot;: 1000},</span>
                                                                <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                                                           <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;GlorotUniform&quot;</span><span class="p">,</span>
                                                                                                  <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                                                                                                  <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span>
                                                                           <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;kernel_regularizer&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;L1L2&quot;</span><span class="p">,</span>
                                                                                                  <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                                                                                                  <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;l1&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                                                                                                             <span class="s2">&quot;l2&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}},</span>
                                                                           <span class="s2">&quot;bias_regularizer&quot;</span><span class="p">:</span> <span class="s2">&quot;L1(l1=0.0001)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;activity_regularizer&quot;</span><span class="p">:</span> <span class="s2">&quot;L1(l1=0.0001)&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;kernel_constraint&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;MaxNorm&quot;</span><span class="p">,</span>
                                                                                                  <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                                                                                                  <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;max_value&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                                                                                             <span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}},</span>
                                                                           <span class="s2">&quot;bias_constraint&quot;</span><span class="p">:</span> <span class="s2">&quot;MaxNorm(max_value=2, axis=0)&quot;</span><span class="p">}},</span>
                                                               <span class="s2">&quot;Activation(&#39;selu&#39;)&quot;</span><span class="p">,</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;BatchNormalization&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                                                                <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;axis&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                                                           <span class="s2">&quot;momentum&quot;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span>
                                                                           <span class="s2">&quot;epsilon&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                                                                           <span class="s2">&quot;center&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                                                           <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                                                           <span class="s2">&quot;beta_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;gamma_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;ones&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;moving_mean_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;moving_variance_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;ones&quot;</span><span class="p">,</span>
                                                                           <span class="s2">&quot;beta_regularizer&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                           <span class="s2">&quot;gamma_regularizer&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                           <span class="s2">&quot;beta_constraint&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                           <span class="s2">&quot;gamma_constraint&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dropout&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span>
                                                                <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;noise_shape&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                           <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span>
                                                               <span class="s2">&quot;BatchNormalization&quot;</span><span class="p">,</span>
                                                               <span class="s2">&quot;AlphaDropout(0.1)&quot;</span><span class="p">,</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;AlphaDropout&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span>
                                                                <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;noise_shape&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                            <span class="s2">&quot;seed&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span>
                                                               <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dense&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span>
                                                                <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
                                                                            <span class="s2">&quot;use_bias&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                                                            <span class="s2">&quot;kernel_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;glorot_uniform&quot;</span><span class="p">,</span>
                                                                            <span class="s2">&quot;bias_initializer&quot;</span><span class="p">:</span> <span class="s2">&quot;zeros&quot;</span><span class="p">,</span>
                                                                            <span class="s2">&quot;kernel_regularizer&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                            <span class="s2">&quot;bias_regularizer&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                            <span class="s2">&quot;activity_regularizer&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                            <span class="s2">&quot;kernel_constraint&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                                                                            <span class="s2">&quot;bias_constraint&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}}],</span>
                                              <span class="s2">&quot;act_func_out_layer&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                              <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                              <span class="s2">&quot;batch_norm&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="c1">#model_optimizer_inputs = &quot;optimizers.Adam(learning_rate = 0.001, beta_1 = 0.9, beta_2 = 0.999, amsgrad = False)&quot;</span>
<span class="n">model_optimizer_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Adam&quot;</span><span class="p">,</span>
<span class="c1">#                          &quot;args&quot;: [],</span>
<span class="c1">#                          &quot;kwargs&quot;: {&quot;learning_rate&quot;: 0.001,</span>
<span class="c1">#                                     &quot;beta_1&quot;: 0.9,</span>
<span class="c1">#                                     &quot;beta_2&quot;: 0.999,</span>
<span class="c1">#                                     &quot;amsgrad&quot;: False}}</span>
<span class="n">model_compile_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
                        <span class="c1">#&quot;loss&quot;: {&quot;name&quot;: &quot;MeanSquaredError&quot;,</span>
                        <span class="c1">#         &quot;args&quot;: [],</span>
                        <span class="c1">#         &quot;kwargs&quot;: {&quot;reduction&quot;: &quot;losses.Reduction.SUM&quot;}},</span>
                        <span class="c1">#&quot;loss&quot;: &quot;MeanSquaredError(reduction=losses.Reduction.SUM)&quot;,</span>
                        <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean_squared_error&quot;</span><span class="p">,</span>
                                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;MeanAbsoluteError&quot;</span><span class="p">,</span>
                                     <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                                     <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;dtype&quot;</span><span class="p">:</span> <span class="s2">&quot;float32&quot;</span><span class="p">}},</span>
                                    <span class="s2">&quot;MeanSquaredLogarithmicError(dtype=&#39;float32&#39;)&quot;</span><span class="p">,</span>
                                    <span class="s2">&quot;mape&quot;</span><span class="p">,</span>
                                    <span class="c1">#&quot;mean_error&quot;,</span>
                                    <span class="s2">&quot;me&quot;</span><span class="p">]}</span>
<span class="n">model_callbacks_inputs</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;EarlyStopping&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                           <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;patience&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                      <span class="s2">&quot;min_delta&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span>
                                      <span class="s2">&quot;restore_best_weights&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
                          <span class="s2">&quot;TerminateOnNaN&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;PlotLossesKeras&quot;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;TensorBoard&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                           <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;log_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;automatically set by the framework&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;histogram_freq&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                      <span class="s2">&quot;write_graph&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                      <span class="s2">&quot;write_images&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                      <span class="s2">&quot;update_freq&quot;</span><span class="p">:</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;profile_batch&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                      <span class="s2">&quot;embeddings_freq&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                      <span class="s2">&quot;embeddings_metadata&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span>
                          <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ReduceLROnPlateau&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                           <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;factor&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                                      <span class="s2">&quot;min_lr&quot;</span><span class="p">:</span> <span class="mf">0.00008</span><span class="p">,</span>
                                      <span class="s2">&quot;patience&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                                      <span class="s2">&quot;min_delta&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">}},</span>
                          <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ModelCheckpoint&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">[],</span>
                           <span class="s2">&quot;kwargs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="s2">&quot;automatically set by the framework&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
                                      <span class="s2">&quot;save_best_only&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                      <span class="s2">&quot;save_freq&quot;</span><span class="p">:</span> <span class="s2">&quot;epoch&quot;</span><span class="p">}}]</span>
<span class="n">model_train_inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
                    <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s2">&quot;validation_freq&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p>Each of the arguments</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="arguments.html#DnnLik.model_data_inputs" title="DnnLik.model_data_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_data_inputs</span></code></a></p></li>
<li><p><a class="reference internal" href="arguments.html#DnnLik.model_define_inputs" title="DnnLik.model_define_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_define_inputs</span></code></a></p></li>
<li><p><a class="reference internal" href="arguments.html#DnnLik.model_optimizer_inputs" title="DnnLik.model_optimizer_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_optimizer_inputs</span></code></a></p></li>
<li><p><a class="reference internal" href="arguments.html#DnnLik.model_compile_inputs" title="DnnLik.model_compile_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_compile_inputs</span></code></a></p></li>
<li><p><a class="reference internal" href="arguments.html#DnnLik.model_callbacks_inputs" title="DnnLik.model_callbacks_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_callbacks_inputs</span></code></a></p></li>
<li><p><a class="reference internal" href="arguments.html#DnnLik.model_train_inputs" title="DnnLik.model_train_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_train_inputs</span></code></a></p></li>
</ul>
</div></blockquote>
<p>are input arguments of the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> class
(see the corresponding documentation pages for a complete description)</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_data_inputs" title="DnnLik.model_data_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_data_inputs</span></code></a> dictionary contains information about the way data are processed
by the DNN. In particular it specifies the number of points for training, validation, and test, if <code class="docutils literal notranslate"><span class="pre">X</span></code> and/or <code class="docutils literal notranslate"><span class="pre">Y</span></code> data
need to be scaled through a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html"  target="_blank"> StandardScalers</a> and if <code class="docutils literal notranslate"><span class="pre">Y</span></code> data need to be weighted. These parameters are passed to the
<a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> container class that is automatically initialized by the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a>
one and that is used for data management.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_define_inputs" title="DnnLik.model_define_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_define_inputs</span></code></a> dictionary contains the main hyperparameters needed to define
the DNN. They are given by the scruture of hidden layers, each of which can be specified in a number of different ways,
the activation function in the output layer, and, optionally, two inputs that simplify the addition of dropout and batch normalization.
When hidden layers are specified through a list of dictionaries, such dictionaries follow the general scheme according to which an object
is specified by three items: <code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code>, representing the object name (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;Dense&quot;</span></code>), <code class="docutils literal notranslate"><span class="pre">&quot;args&quot;,</span> <span class="pre">representing</span> <span class="pre">all</span> <span class="pre">positional</span> <span class="pre">arguments</span>
<span class="pre">(e.g.</span> <span class="pre">``1000</span></code> for the number of unit of a Dense layer), and <code class="docutils literal notranslate"><span class="pre">&quot;kwargs&quot;,</span> <span class="pre">a</span> <span class="pre">dictionary</span> <span class="pre">containing</span> <span class="pre">all</span> <span class="pre">keyword</span> <span class="pre">arguments</span> <span class="pre">(e.g.</span>
<span class="pre">``{&quot;activation&quot;:</span> <span class="pre">&quot;relu&quot;,</span> <span class="pre">&quot;use_bias&quot;:</span> <span class="pre">True}</span></code> for a Dense layer).</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_optimizer_inputs" title="DnnLik.model_optimizer_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_optimizer_inputs</span></code></a> is devoted to the definition of the optimizer.
It can be specified both as a string or a dictionary. In the latter case the same scheme used to input hidden layers in the
<a class="reference internal" href="arguments.html#DnnLik.model_define_inputs" title="DnnLik.model_define_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_define_inputs</span></code></a> dictionary is used. All <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers"  target="_blank"> tf.keras.optimizers</a> are supported.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_compile_inputs" title="DnnLik.model_compile_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_compile_inputs</span></code></a> dictionary defines inputs for the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#compile"  target="_blank"> tf.keras.Model.compile</a>
class. The dictionary contains two items, corresponding to the <code class="docutils literal notranslate"><span class="pre">&quot;loss&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;metrics&quot;</span></code>. The former can be passed both as a string
or a dictionary. The latter is a list of strings and or dictionaries. In both case the input as dictionaries follows the aforementioned
scheme. Lossed and metrics strings may be passed in all formats supported by <a href="https://www.tensorflow.org/api_docs/python/tf/keras"  target="_blank"> tf.keras</a> (e.g. inputs such as <code class="docutils literal notranslate"><span class="pre">&quot;mse&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;mean_squared_error&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;MeanSquaredError&quot;</span></code> are all allowed).</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_compile_inputs" title="DnnLik.model_compile_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_compile_inputs</span></code></a> list contains the list of <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks"  target="_blank"> tf.keras.callbacks</a> to be used
during training. All <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks"  target="_blank"> tf.keras.callbacks</a> are supported. Entries of the list could be strings or dictionaries, following the same
scheme as the other inputs.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_train_inputs" title="DnnLik.model_train_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_train_inputs</span></code></a> dictionary is used to define parameters for the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"  target="_blank"> tf.keras.Model.fit</a>
method. The <code class="docutils literal notranslate"><span class="pre">&quot;epochs&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;batch_size&quot;</span></code> items are mandatory, while any other additional parameter can be added and is directly
passed to the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"  target="_blank"> tf.keras.Model.fit</a> method</p>
<p>The <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object can be instantiated in three different ways, depending on the value of the arguments
<a class="reference internal" href="arguments.html#DnnLik.data" title="DnnLik.data"><code class="xref py py-argument docutils literal notranslate"><span class="pre">data</span></code></a>, <code class="xref py py-argument docutils literal notranslate"><span class="pre">input_data_file</span></code>,
and <a class="reference internal" href="arguments.html#DnnLik.input_file" title="DnnLik.input_file"><code class="xref py py-argument docutils literal notranslate"><span class="pre">input_data_file</span></code></a>. The latter argument determines whether a new object is created from
input arguments (when is set to the default <code class="docutils literal notranslate"><span class="pre">None</span></code>) or the object is imported from a previously saved one (when is set to the corresponding
path). When a new object is created, data can be passed both through an already defined <a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object
or through the path to a previously saved one. If the path is passed, then it is always used and, if also a locally defined
<a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object is passed, it gets ignored.</p>
<p>Starting from the data object we have saved in <a class="reference internal" href="../data/usage.html#data-usage"><span class="std std-ref">the Data object Usage</span></a> section of the documentation,
and using the arguments defined above, we can create a <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span> <span class="o">=</span> <span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">DnnLik</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;DNNLikelihood_toy&quot;</span><span class="p">,</span>
                                     <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">input_data_file</span><span class="o">=</span><span class="s2">&quot;toy/data/toy_data&quot;</span><span class="p">,</span>
                                     <span class="n">load_on_RAM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">same_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">model_data_inputs</span><span class="o">=</span><span class="n">model_data_inputs</span><span class="p">,</span>
                                     <span class="n">model_define_inputs</span><span class="o">=</span><span class="n">model_define_inputs</span><span class="p">,</span>
                                     <span class="n">model_optimizer_inputs</span><span class="o">=</span><span class="n">model_optimizer_inputs</span><span class="p">,</span>
                                     <span class="n">model_compile_inputs</span><span class="o">=</span><span class="n">model_compile_inputs</span><span class="p">,</span>
                                     <span class="n">model_callbacks_inputs</span><span class="o">=</span><span class="n">model_callbacks_inputs</span><span class="p">,</span>
                                     <span class="n">model_train_inputs</span><span class="o">=</span><span class="n">model_train_inputs</span><span class="p">,</span>
                                     <span class="n">resources_inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;toy/dnnlikelihood&quot;</span><span class="p">,</span>
                                     <span class="n">ensemble_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">input_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">==============================</span>
    <span class="n">No</span> <span class="n">DnnLik</span> <span class="nb">input</span> <span class="n">files</span> <span class="ow">and</span> <span class="n">folders</span> <span class="n">specified</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">output</span> <span class="n">folder</span> <span class="nb">set</span> <span class="n">to</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="s1">&#39;standalone&#39;</span> <span class="n">DNNLikelihood</span> <span class="ow">and</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">belong</span> <span class="n">to</span> <span class="n">a</span> <span class="n">DNNLikelihood_ensemble</span><span class="o">.</span> <span class="n">The</span> <span class="n">attributes</span> <span class="s1">&#39;ensemble_name&#39;</span> <span class="ow">and</span> <span class="s1">&#39;ensemble_folder&#39;</span> <span class="n">have</span> <span class="n">therefore</span> <span class="n">been</span> <span class="nb">set</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">No</span> <span class="n">Likelihood</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">been</span> <span class="n">specified</span><span class="o">.</span>

    <span class="mi">88</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span>
    <span class="mi">4</span> <span class="n">GPUs</span> <span class="n">available</span>
    <span class="mi">4</span> <span class="n">GPUs</span> <span class="n">have</span> <span class="n">been</span> <span class="nb">set</span><span class="p">:</span>
    <span class="p">[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:18:00.0, compute capability: 7.5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;/device:GPU:1&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;/device:GPU:2&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:5e:00.0, compute capability: 7.5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;/device:GPU:3&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5&#39;</span><span class="p">]</span> <span class="o">.</span>
    <span class="o">==============================</span>
    <span class="n">Initialize</span> <span class="n">Data</span> <span class="nb">object</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="nb">input</span> <span class="n">folder</span> <span class="nb">set</span> <span class="n">to</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_data_input_folder</span><span class="o">&gt;</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="nb">object</span> <span class="n">loaded</span> <span class="ow">in</span> <span class="mf">0.01520899999923131</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="n">output</span> <span class="n">folder</span> <span class="nb">set</span> <span class="n">to</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_data_output_folder</span><span class="o">&gt;</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_data_output_folder</span><span class="o">&gt;</span>\<span class="n">toy_data</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.002114199999596167</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Setting</span> <span class="n">hidden</span> <span class="n">layers</span>

    <span class="n">Added</span> <span class="n">Input</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,))</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span><span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span><span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1L2</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">initializers</span><span class="o">.</span><span class="n">GlorotUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1L2</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">constraints</span><span class="o">.</span><span class="n">MaxNorm</span><span class="p">(</span><span class="n">max_value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;selu&#39;</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;lecun_normal&#39;</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="n">initializers</span><span class="o">.</span><span class="n">GlorotUniform</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="n">kernel_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1L2</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">l2</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span> <span class="n">bias_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">activity_regularizer</span><span class="o">=</span><span class="n">regularizers</span><span class="o">.</span><span class="n">L1</span><span class="p">(</span><span class="n">l1</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">),</span> <span class="n">kernel_constraint</span><span class="o">=</span><span class="n">constraints</span><span class="o">.</span><span class="n">MaxNorm</span><span class="p">(</span><span class="n">max_value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">bias_constraint</span><span class="o">=</span><span class="n">constraints</span><span class="o">.</span><span class="n">MaxNorm</span><span class="p">(</span><span class="n">max_value</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Activation</span><span class="p">(</span><span class="s1">&#39;selu&#39;</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">beta_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="n">gamma_initializer</span><span class="o">=</span><span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="n">moving_mean_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="n">moving_variance_initializer</span><span class="o">=</span><span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="n">beta_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">beta_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">gamma_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">noise_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">BatchNormalization</span><span class="p">()</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">AlphaDropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">AlphaDropout</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">noise_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">hidden</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">use_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="n">kernel_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bias_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">activity_regularizer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">kernel_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bias_constraint</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">Added</span> <span class="n">Output</span> <span class="n">layer</span><span class="p">:</span>  <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Setting</span> <span class="n">optimizer</span>

    <span class="n">Optimizer</span> <span class="nb">set</span> <span class="n">to</span><span class="p">:</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">beta_1</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">,</span> <span class="n">amsgrad</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="o">==============================</span>
    <span class="n">Setting</span> <span class="n">loss</span>

    <span class="n">Loss</span> <span class="nb">set</span> <span class="n">to</span><span class="p">:</span> <span class="n">losses</span><span class="o">.</span><span class="n">mse</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Setting</span> <span class="n">metrics</span>

            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">MeanAbsoluteError</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">MeanSquaredLogarithmicError</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mape</span>
            <span class="n">Added</span> <span class="n">custom</span> <span class="n">metric</span><span class="p">:</span> <span class="n">mean_error</span>

    <span class="o">==============================</span>
    <span class="n">Setting</span> <span class="n">callbacks</span>

            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">TerminateOnNaN</span><span class="p">()</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">PlotLossesKeras</span><span class="p">()</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">TensorBoard</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;&lt;abs_path_to_output_folder&gt;\tensorboard_logs&#39;</span><span class="p">,</span> <span class="n">histogram_freq</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">write_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">write_images</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_freq</span><span class="o">=</span><span class="s1">&#39;epoch&#39;</span><span class="p">,</span> <span class="n">profile_batch</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">embeddings_freq</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">embeddings_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">min_lr</span><span class="o">=</span><span class="mf">8e-05</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;&lt;abs_path_to_output_folder&gt;\checkpoints\DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s1">-</span><span class="si">{val_loss:.2f}</span><span class="s1">.h5&#39;</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_freq</span><span class="o">=</span><span class="s1">&#39;epoch&#39;</span><span class="p">)</span>

    <span class="o">==============================</span>
    \<span class="n">nJson</span> <span class="n">file</span>\<span class="n">n</span>\<span class="n">t</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_summary</span><span class="o">.</span><span class="n">json</span>
    <span class="n">saved</span> <span class="ow">in</span> <span class="mf">0.004206500000691449</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">saved</span> <span class="ow">in</span> <span class="mf">0.0011275000006207847</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>where we used the placeholders &lt;abs_path_to_input_data_folder&gt;, &lt;abs_path_to_output_data_folder&gt; and &lt;abs_path_to_output_folder&gt; to indicate the
respective paths.</p>
<p>If the <a class="reference internal" href="arguments.html#DnnLik.name" title="DnnLik.name"><code class="xref py py-argument docutils literal notranslate"><span class="pre">name</span></code></a> argument is not passed, then one is automatically generated.
The <a class="reference internal" href="arguments.html#DnnLik.load_on_RAM" title="DnnLik.load_on_RAM"><code class="xref py py-argument docutils literal notranslate"><span class="pre">load_on_RAM</span></code></a> argument is passed directly to the <a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object (see the
documentation of <a class="reference internal" href="../data/arguments.html#Data.load_on_RAM" title="Data.load_on_RAM"><code class="xref py py-argument docutils literal notranslate"><span class="pre">Data.load_on_RAM</span></code></a>). The <a class="reference internal" href="arguments.html#DnnLik.seed" title="DnnLik.seed"><code class="xref py py-argument docutils literal notranslate"><span class="pre">seed</span></code></a> argument is used to
initialize the <a href="https://docs.scipy.org/doc/numpy/index.html"  target="_blank"> numpy</a> and <a href="https://www.tensorflow.org/"  target="_blank"> TensorFlow</a> random number generators. The <a class="reference internal" href="arguments.html#DnnLik.output_folder" title="DnnLik.output_folder"><code class="xref py py-argument docutils literal notranslate"><span class="pre">output_folder</span></code></a> argument
is specified as usual, with a relative or absolute path, and if left unspecified, it is automatically set to the current working
directory.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.same_data" title="DnnLik.same_data"><code class="xref py py-argument docutils literal notranslate"><span class="pre">same_data</span></code></a> and <a class="reference internal" href="arguments.html#DnnLik.ensemble_name" title="DnnLik.ensemble_name"><code class="xref py py-argument docutils literal notranslate"><span class="pre">ensemble_name</span></code></a> arguments
should not be specified by the user (or left <code class="docutils literal notranslate"><span class="pre">None</span></code>) and are automatically passed in case the
<a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is part of a <a class="reference internal" href="../dnn_likelihood_ensemble/index.html#module-dnn_likelihood_ensemble" title="dnn_likelihood_ensemble"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DNNLikEnsemble</span></code></a>.</p>
<p>When the object is created, resources are allocated through the hinerithed class <a class="reference internal" href="../resources/class.html#DNNLikelihood.Resources" title="DNNLikelihood.Resources"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resources</span></code></a> (
see <a class="reference internal" href="../resources/index.html#resources-module"><span class="std std-ref">Resources management</span></a> for details). The <a class="reference internal" href="arguments.html#DnnLik.resources_inputs" title="DnnLik.resources_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">datresources_inputsa</span></code></a>
should not be specified by the user (or left <code class="docutils literal notranslate"><span class="pre">None</span></code>) since it is only used for automatic resources allocation when the object is part
of a <a class="reference internal" href="../dnn_likelihood_ensemble/index.html#module-dnn_likelihood_ensemble" title="dnn_likelihood_ensemble"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DNNLikEnsemble</span></code></a> object.</p>
<p>The <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.__init__" title="DNNLikelihood.DnnLik.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.__init__</span></code></a> method sets several attributes, which can be seen in the following output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="vm">__dict__</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;active_gpus&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:18:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:1&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:2&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:5e:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:3&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5&#39;</span><span class="p">]]]</span>
    <span class="p">[</span><span class="s1">&#39;act_func_out_layer&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;available_cpu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;/device:CPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;Intel(R) Xeon(R) Gold 6152 CPU @ 2.10GHz&#39;</span><span class="p">,</span> <span class="mi">88</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;available_gpus&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:18:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:1&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 1, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:2&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 2, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:5e:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:3&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 3, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5&#39;</span><span class="p">]]]</span>
    <span class="p">[</span><span class="s1">&#39;batch_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;callbacks&#39;</span><span class="p">,</span> <span class="p">[]]</span>
    <span class="p">[</span><span class="s1">&#39;callbacks_strings&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;callbacks.EarlyStopping(monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, patience=100, min_delta=0.0001, restore_best_weights=True)&quot;</span><span class="p">,</span> <span class="s1">&#39;callbacks.TerminateOnNaN()&#39;</span><span class="p">,</span> <span class="s1">&#39;PlotLossesKeras()&#39;</span><span class="p">,</span> <span class="s2">&quot;callbacks.TensorBoard(log_dir=r&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s2">tensorboard_logs&#39;, histogram_freq=0, write_graph=True, write_images=True, update_freq=&#39;epoch&#39;, profile_batch=2, embeddings_freq=0, embeddings_metadata=None)&quot;</span><span class="p">,</span> <span class="s2">&quot;callbacks.ReduceLROnPlateau(monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, factor=0.2, min_lr=8e-05, patience=10, min_delta=0.0001)&quot;</span><span class="p">,</span> <span class="s2">&quot;callbacks.ModelCheckpoint(filepath=r&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s2">checkpoints</span><span class="se">\\</span><span class="s2">DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s2">-</span><span class="si">{val_loss:.2f}</span><span class="s2">.h5&#39;, monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, save_best_only=True, save_freq=&#39;epoch&#39;)&quot;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x00000219FD3327F0</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;dropout_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;ensemble_folder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;ensemble_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;epochs_available&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;epochs_required&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;gpu_mode&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;hidden_layers&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Dense(1000,activation=&#39;relu&#39;,kernel_initializer=&#39;glorot_uniform&#39;,kernel_regularizer=regularizers.L1L2(l1=0.001, l2=0.001))&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;use_bias&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;kernel_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;GlorotUniform(seed=None)&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1L2(l1=0.001, l2=0.001)&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_constraint&#39;</span><span class="p">:</span> <span class="s1">&#39;MaxNorm(max_value=2, axis=0)&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="s1">&#39;Dense(500)&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Activation&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;relu&#39;</span><span class="p">]},</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;selu&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;use_bias&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;kernel_initializer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;GlorotUniform&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="s1">&#39;bias_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_regularizer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;L1L2&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;l1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}},</span> <span class="s1">&#39;bias_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_constraint&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;MaxNorm&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;max_value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}},</span> <span class="s1">&#39;bias_constraint&#39;</span><span class="p">:</span> <span class="s1">&#39;MaxNorm(max_value=2, axis=0)&#39;</span><span class="p">}},</span> <span class="s2">&quot;Activation(&#39;selu&#39;)&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BatchNormalization&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;momentum&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;beta_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="s1">&#39;moving_mean_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;moving_variance_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="s1">&#39;beta_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;gamma_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;beta_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;gamma_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dropout&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;noise_shape&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="s1">&#39;BatchNormalization&#39;</span><span class="p">,</span> <span class="s1">&#39;AlphaDropout(0.1, seed=2)&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;AlphaDropout&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;noise_shape&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;use_bias&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;kernel_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;bias_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;activity_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;kernel_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;bias_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}}]]</span>
    <span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">,</span> <span class="p">{}]</span>
    <span class="p">[</span><span class="s1">&#39;idx_test&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;idx_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;idx_val&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;input_data_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_data_input_folder&gt;</span><span class="se">\\</span><span class="s1">toy_data&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_files_base_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_folder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_history_json_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_idx_h5_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_likelihood_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_log_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_predictions_h5_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_scalers_pickle_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_tf_model_h5_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;layers&#39;</span><span class="p">,</span> <span class="p">[]]</span>
    <span class="p">[</span><span class="s1">&#39;layers_string&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;layers.Input(shape=(11,))&#39;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(1000,activation=&#39;relu&#39;,kernel_initializer=&#39;glorot_uniform&#39;,kernel_regularizer=regularizers.L1L2(l1=0.001, l2=0.001))&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(1000, activation=&#39;relu&#39;, use_bias=True, kernel_initializer=initializers.GlorotUniform(seed=None), bias_initializer=&#39;zeros&#39;, kernel_regularizer=regularizers.L1L2(l1=0.001, l2=0.001), bias_regularizer=regularizers.L1(l1=0.0001), activity_regularizer=regularizers.L1(l1=0.0001), kernel_constraint=constraints.MaxNorm(max_value=2, axis=0), bias_constraint=None)&quot;</span><span class="p">,</span> <span class="s1">&#39;layers.Dense(500)&#39;</span><span class="p">,</span> <span class="s2">&quot;layers.Activation(&#39;relu&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(100, activation=&#39;selu&#39;, kernel_initializer=&#39;lecun_normal&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(100, activation=&#39;relu&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(1000, use_bias=True, kernel_initializer=initializers.GlorotUniform(seed=None), bias_initializer=&#39;zeros&#39;, kernel_regularizer=regularizers.L1L2(l1=0.001, l2=0.001), bias_regularizer=regularizers.L1(l1=0.0001), activity_regularizer=regularizers.L1(l1=0.0001), kernel_constraint=constraints.MaxNorm(max_value=2, axis=0), bias_constraint=constraints.MaxNorm(max_value=2, axis=0))&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.Activation(&#39;selu&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.BatchNormalization(axis=-1, momentum=0.99, epsilon=0.001, center=True, scale=True, beta_initializer=&#39;zeros&#39;, gamma_initializer=&#39;ones&#39;, moving_mean_initializer=&#39;zeros&#39;, moving_variance_initializer=&#39;ones&#39;, beta_regularizer=None, gamma_regularizer=None, beta_constraint=None, gamma_constraint=None)&quot;</span><span class="p">,</span> <span class="s1">&#39;layers.Dropout(0.1, noise_shape=None, seed=None)&#39;</span><span class="p">,</span> <span class="s1">&#39;layers.BatchNormalization()&#39;</span><span class="p">,</span> <span class="s1">&#39;layers.AlphaDropout(0.1, seed=2)&#39;</span><span class="p">,</span> <span class="s1">&#39;layers.AlphaDropout(0.1, noise_shape=None, seed=None)&#39;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(1000, activation=&#39;relu&#39;, use_bias=True, kernel_initializer=&#39;glorot_uniform&#39;, bias_initializer=&#39;zeros&#39;, kernel_regularizer=None, bias_regularizer=None, activity_regularizer=None, kernel_constraint=None, bias_constraint=None)&quot;</span><span class="p">,</span> <span class="s2">&quot;layers.Dense(1, activation=&#39;linear&#39;)&quot;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;likelihood&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;load_on_RAM&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;datetime_2021_12_02_14_15_23_3239&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;created&#39;</span><span class="p">},</span> <span class="s1">&#39;datetime_2021_12_02_14_15_25_0959&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;optimizer set&#39;</span><span class="p">,</span> <span class="s1">&#39;optimizer&#39;</span><span class="p">:</span> <span class="s1">&#39;optimizers.Adam(learning_rate = 0.001, beta_1 = 0.9, beta_2 = 0.999, amsgrad = False)&#39;</span><span class="p">},</span> <span class="s1">&#39;datetime_2021_12_02_14_15_25_0969&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;loss set&#39;</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;losses.mse&#39;</span><span class="p">},</span> <span class="s1">&#39;datetime_2021_12_02_14_15_27_9999&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;metrics set&#39;</span><span class="p">,</span> <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;metrics.mean_squared_error&#39;</span><span class="p">,</span> <span class="s2">&quot;metrics.MeanAbsoluteError(dtype=&#39;float32&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;metrics.MeanSquaredLogarithmicError(dtype=&#39;float32&#39;)&quot;</span><span class="p">,</span> <span class="s1">&#39;metrics.mape&#39;</span><span class="p">,</span> <span class="s1">&#39;self.mean_error&#39;</span><span class="p">]},</span> <span class="s1">&#39;datetime_2021_12_02_14_15_28_0059&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;saved object json&#39;</span><span class="p">,</span> <span class="s1">&#39;file name&#39;</span><span class="p">:</span> <span class="s1">&#39;DNNLikelihood_toy_summary.json&#39;</span><span class="p">}}]</span>
    <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;loss_string&#39;</span><span class="p">,</span> <span class="s1">&#39;losses.mse&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">,</span> <span class="p">[]]</span>
    <span class="p">[</span><span class="s1">&#39;metrics_string&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;metrics.mean_squared_error&#39;</span><span class="p">,</span> <span class="s2">&quot;metrics.MeanAbsoluteError(dtype=&#39;float32&#39;)&quot;</span><span class="p">,</span> <span class="s2">&quot;metrics.MeanSquaredLogarithmicError(dtype=&#39;float32&#39;)&quot;</span><span class="p">,</span> <span class="s1">&#39;metrics.mape&#39;</span><span class="p">,</span> <span class="s1">&#39;self.mean_error&#39;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;model_train_kwargs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;validation_freq&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;DNNLikelihood_toy&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;ndims&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_available&#39;</span><span class="p">,</span> <span class="mi">200000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_test&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_test_available&#39;</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_train&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_train_val_available&#39;</span><span class="p">,</span> <span class="mi">140000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_val&#39;</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;optimizer_string&#39;</span><span class="p">,</span> <span class="s1">&#39;optimizers.Adam(learning_rate = 0.001, beta_1 = 0.9, beta_2 = 0.999, amsgrad = False)&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_checkpoints_files&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">checkpoints</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s1">-</span><span class="si">{val_loss:.2f}</span><span class="s1">.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_checkpoints_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">checkpoints&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figures_base_file_name&#39;</span><span class="p">,</span> <span class="s1">&#39;DNNLikelihood_toy_figure&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figures_base_file_path&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">figures</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_figure&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figures_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">figures&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figure_plot_losses_keras_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_files_base_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_history_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_history.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_idx_h5_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_idx.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_log_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy.log&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_predictions_h5_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_predictions.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_predictions_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_predictions.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_scalers_pickle_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_scalers.pickle&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_summary.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tensorboard_log_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">tensorboard_logs&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_graph_pdf_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_model_graph.pdf&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_h5_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_model.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_model.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_onnx_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_model.onnx&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;pars_bounds&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">5.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">]])]</span>
    <span class="p">[</span><span class="s1">&#39;pars_central&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
    <span class="p">[</span><span class="s1">&#39;pars_labels&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">mu$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{0}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{3}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{5}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{6}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{7}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{8}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{9}</span><span class="s1">$&#39;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;pars_labels_auto&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">theta_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{3}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{5}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{6}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{7}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{8}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{9}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">nu_</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;pars_pos_nuis&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
    <span class="p">[</span><span class="s1">&#39;pars_pos_poi&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])]</span>
    <span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Model_evaluation&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;Bayesian_inference&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;Frequentist_inference&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;Figures&#39;</span><span class="p">:</span> <span class="p">{}}]</span>
    <span class="p">[</span><span class="s1">&#39;same_data&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerX&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerX_bool&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerY&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerY_bool&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;script_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_script.py&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;standalone&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;W_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;X_test&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;X_val&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;Y_test&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;Y_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;Y_val&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_callbacks_inputs&#39;</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;EarlyStopping&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;monitor&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;patience&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;min_delta&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s1">&#39;restore_best_weights&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span> <span class="s1">&#39;TerminateOnNaN&#39;</span><span class="p">,</span> <span class="s1">&#39;PlotLossesKeras&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;TensorBoard&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;log_dir&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">tensorboard_logs&#39;</span><span class="p">,</span> <span class="s1">&#39;histogram_freq&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;write_graph&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;write_images&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;update_freq&#39;</span><span class="p">:</span> <span class="s1">&#39;epoch&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_batch&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;embeddings_freq&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;embeddings_metadata&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ReduceLROnPlateau&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;monitor&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;factor&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;min_lr&#39;</span><span class="p">:</span> <span class="mf">8e-05</span><span class="p">,</span> <span class="s1">&#39;patience&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;min_delta&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ModelCheckpoint&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;filepath&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;</span><span class="se">\\</span><span class="s1">checkpoints</span><span class="se">\\</span><span class="s1">DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s1">-</span><span class="si">{val_loss:.2f}</span><span class="s1">.h5&#39;</span><span class="p">,</span> <span class="s1">&#39;monitor&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;save_best_only&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;save_freq&#39;</span><span class="p">:</span> <span class="s1">&#39;epoch&#39;</span><span class="p">}}]]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_compile_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;MeanAbsoluteError&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;float32&#39;</span><span class="p">}},</span> <span class="s2">&quot;MeanSquaredLogarithmicError(dtype=&#39;float32&#39;)&quot;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_data_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;npoints&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span> <span class="s1">&#39;scalerX&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;scalerY&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;weighted&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_define_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden_layers&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dense(1000,activation=&#39;relu&#39;,kernel_initializer=&#39;glorot_uniform&#39;,kernel_regularizer=regularizers.L1L2(l1=0.001, l2=0.001))&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;use_bias&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;kernel_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;GlorotUniform(seed=None)&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1L2(l1=0.001, l2=0.001)&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_constraint&#39;</span><span class="p">:</span> <span class="s1">&#39;MaxNorm(max_value=2, axis=0)&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="s1">&#39;Dense(500)&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Activation&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;relu&#39;</span><span class="p">]},</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;selu&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;use_bias&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;kernel_initializer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;GlorotUniform&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="s1">&#39;bias_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_regularizer&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;L1L2&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;l1&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;l2&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">}},</span> <span class="s1">&#39;bias_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;activity_regularizer&#39;</span><span class="p">:</span> <span class="s1">&#39;L1(l1=0.0001)&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_constraint&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;MaxNorm&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;max_value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}},</span> <span class="s1">&#39;bias_constraint&#39;</span><span class="p">:</span> <span class="s1">&#39;MaxNorm(max_value=2, axis=0)&#39;</span><span class="p">}},</span> <span class="s2">&quot;Activation(&#39;selu&#39;)&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;BatchNormalization&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;momentum&#39;</span><span class="p">:</span> <span class="mf">0.99</span><span class="p">,</span> <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;beta_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;gamma_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="s1">&#39;moving_mean_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;moving_variance_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;ones&#39;</span><span class="p">,</span> <span class="s1">&#39;beta_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;gamma_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;beta_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;gamma_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dropout&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;noise_shape&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="s1">&#39;BatchNormalization&#39;</span><span class="p">,</span> <span class="s1">&#39;AlphaDropout(0.1, seed=2)&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;AlphaDropout&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;noise_shape&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;seed&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Dense&#39;</span><span class="p">,</span> <span class="s1">&#39;args&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;kwargs&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;activation&#39;</span><span class="p">:</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;use_bias&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;kernel_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;bias_initializer&#39;</span><span class="p">:</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span> <span class="s1">&#39;kernel_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;bias_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;activity_regularizer&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;kernel_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;bias_constraint&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}}],</span> <span class="s1">&#39;act_func_out_layer&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;batch_norm&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_optimizer_inputs&#39;</span><span class="p">,</span> <span class="s1">&#39;optimizers.Adam(learning_rate = 0.001, beta_1 = 0.9, beta_2 = 0.999, amsgrad = False)&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_train_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span> <span class="s1">&#39;shuffle&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;validation_freq&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__resources_inputs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
<p>Notice that the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.__init__" title="DNNLikelihood.DnnLik.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.__init__</span></code></a> method initializes
all attributes, leaving empty (with the correct type), all those arguments that will be populated during the object usage.
As it can be seen from the output of the object creation code, the object is saved upon creation. In case old files exist in the
specified path, they (the old ones) are renamed by appending a timestamp to them.</p>
<p>Once the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is created, the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_build" title="DNNLikelihood.DnnLik.model_build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_build</span></code></a>
method is used to create the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"  target="_blank"> tf.keras.Model</a> and compile it on the available resources as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">model_build</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">==============================</span>
    <span class="n">Defining</span> <span class="ow">and</span> <span class="n">compiling</span> <span class="n">Keras</span> <span class="n">model</span>

    <span class="n">Building</span> <span class="n">tf</span> <span class="n">model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">on</span> <span class="n">device</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: NVIDIA GeForce RTX 2080 Ti, pci bus id: 0000:18:00.0, compute capability: 7.5&#39;</span><span class="p">]</span> <span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Defining</span> <span class="n">Keras</span> <span class="n">model</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.001136699999733537</span> <span class="n">s</span><span class="o">.</span>

    <span class="n">Model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">defined</span> <span class="ow">in</span> <span class="mf">1.8786916000008205</span> <span class="n">s</span><span class="o">.</span>

    <span class="n">Model</span><span class="p">:</span> <span class="s2">&quot;functional_1&quot;</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">Layer</span> <span class="p">(</span><span class="nb">type</span><span class="p">)</span>                 <span class="n">Output</span> <span class="n">Shape</span>              <span class="n">Param</span> <span class="c1">#</span>
    <span class="o">=================================================================</span>
    <span class="n">input_1</span> <span class="p">(</span><span class="n">InputLayer</span><span class="p">)</span>         <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>              <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_28</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">12000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_29</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">1001000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_30</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>               <span class="mi">500500</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">activation_8</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>               <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_31</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>               <span class="mi">50100</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_32</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>               <span class="mi">10100</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_33</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">101000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">activation_9</span> <span class="p">(</span><span class="n">Activation</span><span class="p">)</span>    <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">batch_normalization_8</span> <span class="p">(</span><span class="n">Batch</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">4000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dropout_4</span> <span class="p">(</span><span class="n">Dropout</span><span class="p">)</span>          <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">batch_normalization_9</span> <span class="p">(</span><span class="n">Batch</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">4000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">alpha_dropout_8</span> <span class="p">(</span><span class="n">AlphaDropou</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">alpha_dropout_9</span> <span class="p">(</span><span class="n">AlphaDropou</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_34</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>              <span class="mi">1001000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_35</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>             <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>                 <span class="mi">1001</span>
    <span class="o">=================================================================</span>
    <span class="n">Total</span> <span class="n">params</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="mi">684</span><span class="p">,</span><span class="mi">701</span>
    <span class="n">Trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="mi">680</span><span class="p">,</span><span class="mi">701</span>
    <span class="n">Non</span><span class="o">-</span><span class="n">trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span><span class="mi">000</span>
    <span class="n">_________________________________________________________________</span>
    <span class="o">==============================</span>
    <span class="n">Compiling</span> <span class="n">Keras</span> <span class="n">model</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0010114000006069546</span> <span class="n">s</span><span class="o">.</span>

    <span class="n">Model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">compiled</span> <span class="ow">in</span> <span class="mf">0.022523999999975786</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0020632999994631973</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>This method uses the methods <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_define" title="DNNLikelihood.DnnLik.model_define"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_define</span></code></a> and
<a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_compile" title="DNNLikelihood.DnnLik.model_compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_compile</span></code></a> and implements the <a href="https://www.tensorflow.org/api_docs/python/tf/distribute/OneDeviceStrategy"  target="_blank"> tf.distribute.OneDeviceStrategy</a> strategy to
place the compiled model on a specified (e.g. <code class="docutils literal notranslate"><span class="pre">gpu=1</span></code>) or unspecified (i.e. <code class="docutils literal notranslate"><span class="pre">gpu=&quot;auto&quot;</span></code>) device. The <code class="docutils literal notranslate"><span class="pre">force</span></code> argument determines
if the model is re-generated and/or re-compiled even if already available, while the <code class="docutils literal notranslate"><span class="pre">verbose=2</span></code> ensures that all <code class="docutils literal notranslate"><span class="pre">print</span></code> commands
from each of the methods called within the method are active. The method sets, among others, the
<a class="reference internal" href="attributes.html#DNNLikelihood.DnnLik.model" title="DNNLikelihood.DnnLik.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DnnLik.model</span></code></a> attribute, which is the principal object containing the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"  target="_blank"> tf.keras.Model</a>.</p>
<p>The DNNLikelihood is now ready for training with the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_train" title="DNNLikelihood.DnnLik.model_train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_train</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">model_train</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">&lt;</span><span class="n">image</span><span class="o">&gt;</span>

            <span class="n">Loss</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.228</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>   <span class="mf">33.063</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.228</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.836</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>   <span class="mf">32.746</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.857</span><span class="p">)</span>
    <span class="n">mean_absolute_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.195</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">1.033</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.195</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.585</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">1.996</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.800</span><span class="p">)</span>
    <span class="n">mean_absolute_percentage_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>  <span class="mf">491.900</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span> <span class="mf">7270.143</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span> <span class="mf">1459.488</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>  <span class="mf">131.199</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span> <span class="mf">1814.549</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>  <span class="mf">696.519</span><span class="p">)</span>
    <span class="n">mean_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.036</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.163</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.036</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.050</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">1.997</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.798</span><span class="p">)</span>
    <span class="n">mean_squared_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.065</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">1.955</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.065</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.576</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">4.190</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.716</span><span class="p">)</span>
    <span class="n">mean_squared_logarithmic_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.010</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.194</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.010</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.049</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.663</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.132</span><span class="p">)</span>
    <span class="mi">20</span><span class="o">/</span><span class="mi">20</span> <span class="o">-</span> <span class="mi">4</span><span class="n">s</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">0.2276</span> <span class="o">-</span> <span class="n">mean_squared_error</span><span class="p">:</span> <span class="mf">0.0650</span> <span class="o">-</span> <span class="n">mean_absolute_error</span><span class="p">:</span> <span class="mf">0.1951</span> <span class="o">-</span> <span class="n">mean_squared_logarithmic_error</span><span class="p">:</span> <span class="mf">0.0100</span> <span class="o">-</span> <span class="n">mean_absolute_percentage_error</span><span class="p">:</span> <span class="mf">1459.4880</span> <span class="o">-</span> <span class="n">mean_error</span><span class="p">:</span> <span class="mf">0.0361</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mf">0.8567</span> <span class="o">-</span> <span class="n">val_mean_squared_error</span><span class="p">:</span> <span class="mf">0.7160</span> <span class="o">-</span> <span class="n">val_mean_absolute_error</span><span class="p">:</span> <span class="mf">0.7998</span> <span class="o">-</span> <span class="n">val_mean_squared_logarithmic_error</span><span class="p">:</span> <span class="mf">0.1316</span> <span class="o">-</span> <span class="n">val_mean_absolute_percentage_error</span><span class="p">:</span> <span class="mf">696.5186</span> <span class="o">-</span> <span class="n">val_mean_error</span><span class="p">:</span> <span class="mf">0.7978</span>
    <span class="n">No</span> <span class="n">existing</span> <span class="n">history</span><span class="o">.</span> <span class="n">Setting</span> <span class="n">new</span> <span class="n">history</span><span class="o">.</span>

    <span class="n">Updating</span> <span class="n">model</span><span class="o">.</span><span class="n">history</span> <span class="ow">and</span> <span class="n">model</span><span class="o">.</span><span class="n">epoch</span> <span class="n">attribute</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0015487000000007356</span> <span class="n">s</span><span class="o">.</span>

    <span class="n">Model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">successfully</span> <span class="n">trained</span> <span class="k">for</span> <span class="mi">50</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">309.6447003</span> <span class="n">s</span> <span class="p">(</span> <span class="mf">6.192894006</span> <span class="n">s</span><span class="o">/</span><span class="n">epoch</span><span class="p">)</span><span class="o">.</span>
</pre></div>
</div>
<p>where &lt;image&gt; shows the training in real time whose final result is:</p>
<a class="with-shadow reference internal image-reference" href="../_images/plotlosseskeras.png"><img alt="../_images/plotlosseskeras.png" class="with-shadow" src="../_images/plotlosseskeras.png" style="width: 713.4px; height: 953.4px;" /></a>
<p>In this example we have used the <code class="docutils literal notranslate"><span class="pre">PlotLossesKeras</span></code> callback from <a href="https://github.com/stared/livelossplot/"  target="_blank"> livelossplot</a> to plot the metrics in real time
during training. Notice that this may be useful for quick checks, but it slows down training and is not optimal for long trainings.
For more robust logging the use of the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks/TensorBoard"  target="_blank"> tf.keras.callbacks.ModelCheckpoint</a> callback is suggested.
Since no data were available yet when the method was called, training and validation data generation was done automatically.
The user may want to generate data in advance, which can be done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">generate_train_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">generate_test_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">==============================</span>
    <span class="n">Generating</span> <span class="n">train</span><span class="o">/</span><span class="n">validation</span> <span class="n">data</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_data_output_folder</span><span class="o">&gt;</span>\<span class="n">toy_data</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0032989999999983866</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Added</span> <span class="mi">10000</span> <span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span> <span class="n">samples</span> <span class="ow">and</span> <span class="mi">3000</span> <span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">)</span> <span class="n">samples</span> <span class="ow">in</span> <span class="mf">16.587983899999998</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Setting</span> <span class="n">standard</span> <span class="n">scalers</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_data_output_folder</span><span class="o">&gt;</span>\<span class="n">toy_data</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0027511999999987324</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Standard</span> <span class="n">scalers</span> <span class="n">defined</span> <span class="ow">in</span> <span class="mf">0.0039535000000014975</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0020138000000002876</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Generating</span> <span class="n">test</span> <span class="n">data</span>

    <span class="o">==============================</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_data_output_folder</span><span class="o">&gt;</span>\<span class="n">toy_data</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0026599999999987745</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Added</span> <span class="mi">5000</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span> <span class="n">samples</span> <span class="ow">in</span> <span class="mf">0.08260440000000102</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0012887000000034732</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>Data generation is taken care by the <a class="reference internal" href="attributes.html#DNNLikelihood.DnnLik.data" title="DNNLikelihood.DnnLik.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DnnLik.data</span></code></a> attribute, which is a
<a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object (see <a class="reference internal" href="../data/index.html#module-data" title="data"><code class="xref py py-mod docutils literal notranslate"><span class="pre">the</span> <span class="pre">Data</span> <span class="pre">object</span></code></a> documentation for more details on data management).</p>
<p>The <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is saved automatically after performing operations with its methods.
However, the user can also save it at any time with the commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">==============================</span>
    <span class="n">Idx</span> <span class="n">h5</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_idx</span><span class="o">.</span><span class="n">h5</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.004034199999978227</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Model</span> <span class="n">json</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_model</span><span class="o">.</span><span class="n">json</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.004750500000000102</span> <span class="n">s</span><span class="o">.</span>

    <span class="n">tf</span> <span class="n">executing</span> <span class="n">eager_mode</span><span class="p">:</span> <span class="kc">True</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span> <span class="n">model</span> <span class="n">eager_mode</span><span class="p">:</span> <span class="kc">False</span>
    <span class="o">==============================</span>
    <span class="n">Mode</span> <span class="n">h5</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_model</span><span class="o">.</span><span class="n">h5</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">1.9676557999999886</span> <span class="n">s</span><span class="o">.</span>

    <span class="n">The</span> <span class="n">ONNX</span> <span class="n">operator</span> <span class="n">number</span> <span class="n">change</span> <span class="n">on</span> <span class="n">the</span> <span class="n">optimization</span><span class="p">:</span> <span class="mi">35</span> <span class="o">-&gt;</span> <span class="mi">25</span>
    <span class="n">The</span> <span class="n">maximum</span> <span class="n">opset</span> <span class="n">needed</span> <span class="n">by</span> <span class="n">this</span> <span class="n">model</span> <span class="ow">is</span> <span class="n">only</span> <span class="mf">9.</span>
    <span class="o">==============================</span>
    <span class="n">Mode</span> <span class="n">onnx</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_model</span><span class="o">.</span><span class="n">onnx</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">9.157906899999944</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Mode</span> <span class="n">history</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_history</span><span class="o">.</span><span class="n">json</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.004860199999939141</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Predictions</span> <span class="n">json</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_predictions</span><span class="o">.</span><span class="n">json</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0007312000000183616</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Predictions</span> <span class="n">h5</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_predictions</span><span class="o">.</span><span class="n">h5</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.004424099999937425</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    \<span class="n">nJson</span> <span class="n">file</span>\<span class="n">n</span>\<span class="n">t</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_summary</span><span class="o">.</span><span class="n">json</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.004021100000045408</span> <span class="n">s</span><span class="o">.</span>

    <span class="o">==============================</span>
    <span class="n">Scalers</span> <span class="n">pickle</span> <span class="n">file</span>
             <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_scalers</span><span class="o">.</span><span class="n">pickle</span>
    <span class="n">updated</span> <span class="p">(</span><span class="ow">or</span> <span class="n">saved</span> <span class="k">if</span> <span class="n">it</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">)</span> <span class="ow">in</span> <span class="mf">0.0013580999999476262</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>Now that the DNNLikelihood is built and trained, one can proceed to evaluate its performances. There are several methods to compute
metrics and make plots, whose extensive guide is available in the <a class="reference internal" href="methods.html#dnnlik-methods"><span class="std std-ref">methods documentation</span></a>. The framework also
includes the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_compute_predictions" title="DNNLikelihood.DnnLik.model_compute_predictions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_compute_predictions</span></code></a> method,
devoted to a comprehensive evaluation of the model performances. An example of its usage is the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>dnnlikelihood.model_compute_predictions(CI=DNNLikelihood.inference.CI_from_sigma([DNNLikelihood.inference.sigma_from_CI(0.5), 1, 2, 3]),
                                        pars=[0,2,4,5,8],
                                        batch_size=None,
                                        model_predictions={&quot;Model_evaluation&quot;: True,
                                                           &quot;Bayesian_inference&quot;: True,
                                                           &quot;Frequentist_inference&quot;: True},
                                        plots={&quot;plot_training_history&quot;: True,
                                               &quot;plot_pars_coverage&quot;: True,
                                               &quot;plot_lik_distribution&quot;: True,
                                               &quot;plot_corners_1samp&quot;: True,
                                               &quot;plot_corners_2samp&quot;: True,
                                               &quot;plot_tmu_sources_1d&quot;: True},
                                        model_predict_kwargs = {&quot;x_boundaries&quot;: &quot;original&quot;,
                                                                &quot;y_boundaries&quot;: False,
                                                                &quot;save_log&quot;: False},
                                        HPDI_kwargs = {&quot;nbins&quot;: 25,
                                                       &quot;print_hist&quot;: False,
                                                       &quot;optimize_binning&quot;: True},
                                        frequentist_inference_options={&quot;input_likelihood_file&quot;: None,
                                                                       &quot;compute_maximum_likelihood_kwargs&quot;: {&quot;pars_init&quot;: np.full(11,1).tolist(),
                                                                                                             &quot;verbose&quot;: True},
                                                                       &quot;compute_profiled_maxima_likelihood_kwargs&quot;: {&quot;pars&quot;: [0],
                                                                                                                     &quot;pars_ranges&quot;: [[0,1,10]],
                                                                                                                     &quot;pars_init&quot;: None,
                                                                                                                     &quot;spacing&quot;: &quot;grid&quot;,
                                                                                                                     &quot;optimizer&quot;: {&quot;method&quot;: &quot;Powell&quot;,
                                                                                                                                   &quot;options&quot;: {&quot;maxiter&quot;: 10000,
                                                                                                                                               &quot;ftol&quot;: 0.0001}},
                                                                                                                     &quot;progressbar&quot;: True,
                                                                                                                     &quot;verbose&quot;: True},
                                                                       &quot;compute_maximum_sample_kwargs&quot;: {&quot;samples&quot;: [&quot;train&quot;,&quot;val&quot;,&quot;test&quot;],
                                                                                                         &quot;save&quot;: False,
                                                                                                         &quot;verbose&quot;: True},
                                                                       &quot;compute_profiled_maxima_sample_kwargs&quot;: {&quot;pars&quot;: [0],
                                                                                                                 &quot;pars_ranges&quot;: [[0,1,10]],
                                                                                                                 &quot;samples&quot;: [&quot;train&quot;,&quot;val&quot;,&quot;test&quot;],
                                                                                                                 &quot;spacing&quot;: &quot;grid&quot;,
                                                                                                                 &quot;binwidths&quot;: &quot;auto&quot;,
                                                                                                                 &quot;x_boundaries&quot;: False,
                                                                                                                 &quot;progressbar&quot;: True,
                                                                                                                 &quot;save&quot;: False,
                                                                                                                 &quot;verbose&quot;: True},
                                                                       &quot;compute_maximum_model_kwargs&quot;: {&quot;pars_init&quot;: None,
                                                                                                        &quot;optimizer&quot;: {&quot;name&quot;: &quot;SGD&quot;,
                                                                                                                      &quot;learning_rate&quot;: 1,
                                                                                                                      &quot;options&quot;: {&quot;maxiter&quot;: 10000,
                                                                                                                                 &quot;run_length&quot;: 100,
                                                                                                                                 &quot;tolerance&quot;: 0.0001}},
                                                                                                                      #&quot;beta_1&quot;: 0.9,
                                                                                                                      #&quot;beta_2&quot;: 0.999,
                                                                                                                      #&quot;amsgrad&quot;: False},
                                                                                                        &quot;x_boundaries&quot;: False,
                                                                                                        &quot;y_boundaries&quot;: False,
                                                                                                        &quot;verbose&quot;: True},
                                                                       &quot;compute_profiled_maxima_model_kwargs&quot;: {&quot;pars&quot;: [0],
                                                                                                                &quot;pars_ranges&quot;: [[0,1,10]],
                                                                                                                &quot;pars_init&quot;: None,
                                                                                                                &quot;optimizer&quot;: {&quot;name&quot;: &quot;SGD&quot;,
                                                                                                                              &quot;learning_rate&quot;: 1,
                                                                                                                              &quot;options&quot;: {&quot;maxiter&quot;: 10000,
                                                                                                                                         &quot;run_length&quot;: 100,
                                                                                                                                         &quot;tolerance&quot;: 0.0001}},
                                                                                                                #&quot;optimizer&quot;: {&quot;name&quot;: &quot;scipy&quot;,
                                                                                                                #              &quot;method&quot;: &quot;Powell&quot;,
                                                                                                                #              &quot;options&quot;: {&quot;maxiter&quot;: 10000,
                                                                                                                #                          &quot;ftol&quot;: 0.000001}},
                                                                                                                &quot;spacing&quot;: &quot;grid&quot;,
                                                                                                                &quot;x_boundaries&quot;: False,
                                                                                                                &quot;y_boundaries&quot;: False,
                                                                                                                &quot;progressbar&quot;: True,
                                                                                                                &quot;save&quot;: False,
                                                                                                                &quot;verbose&quot;: True},
                                                                      },
                                        plot_training_history_kwargs = {&quot;metrics&quot;: [&quot;loss&quot;, &quot;me&quot;],
                                                                        &quot;yscale&quot;: &quot;linear&quot;,
                                                                        &quot;show_plot&quot;: True,
                                                                        &quot;overwrite&quot;: True,
                                                                        &quot;verbose&quot;: True},
                                        plot_pars_coverage_kwargs = {&quot;loglik&quot;: False,
                                                                     &quot;show_plot&quot;: True,
                                                                     &quot;overwrite&quot;: True,
                                                                     &quot;verbose&quot;: True},
                                        plot_lik_distribution_kwargs = {&quot;loglik&quot;: False,
                                                                        &quot;show_plot&quot;: True,
                                                                        &quot;overwrite&quot;: True,
                                                                        &quot;verbose&quot;: True},
                                        plot_corners_1samp_kwargs={&quot;ranges_extend&quot;: 1.3,
                                                                   &quot;max_points&quot;: 100000,
                                                                   &quot;nbins&quot;: 60,
                                                                   &quot;legend_loc&quot;: &quot;upper right&quot;,
                                                                   &quot;show_plot&quot;: True,
                                                                   &quot;overwrite&quot;: True,
                                                                   &quot;verbose&quot;: True},
                                        plot_corners_2samp_kwargs = {&quot;ranges_extend&quot;: 1.3,
                                                                     &quot;max_points&quot;: 100000,
                                                                     &quot;nbins&quot;: 60,
                                                                     &quot;legend_loc&quot;: &quot;upper right&quot;,
                                                                     &quot;show_plot&quot;: True,
                                                                     &quot;overwrite&quot;: True,
                                                                     &quot;verbose&quot;: True},
                                        plot_tmu_sources_1d_kwargs = {&quot;sources&quot;: [&quot;likelihood&quot;,&quot;model&quot;,&quot;train&quot;,&quot;val&quot;,&quot;test&quot;],
                                                                      &quot;show_plot&quot;: True,
                                                                      &quot;overwrite&quot;: True,
                                                                      &quot;verbose&quot;: True},
                                        show_plots=True,
                                        overwrite=False,
                                        verbose=2)

&gt;&gt;&gt; ==============================
    Computing predictions for DNNLikelihood model

    ==============================
    Performing Model evaluation

    ==============================
    Generating train/validation data

    ==============================
    Loaded train data corresponding to existing indices.

    ==============================
    Loaded val data corresponding to existing indices.

    ==============================
    Loaded test data corresponding to existing indices.

    ==============================
    Data log file
             C:\Users\Admin\Dropbox\Work\09_Resources\Git\GitHub\DNNLikelihood\DNNLikelihood_dev_tutorials\tutorials\toy\toy\data\toy_data.log
    updated (or saved if it did not exist) in 0.0036706000000208405 s.

    ==============================
    Added 0 (X_train, Y_train) samples and 0 (X_val, Y_val) samples in 18.42952059999999 s.

    ==============================
    Setting standard scalers

    ==============================
    Data log file
             C:\Users\Admin\Dropbox\Work\09_Resources\Git\GitHub\DNNLikelihood\DNNLikelihood_dev_tutorials\tutorials\toy\toy\data\toy_data.log
    updated (or saved if it did not exist) in 0.003842600000012908 s.

    ==============================
    Standard scalers defined in 0.004359499999992522 s.

    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.008558500000020786 s.

    ==============================
    Generating test data

    ==============================
    Data log file
             C:\Users\Admin\Dropbox\Work\09_Resources\Git\GitHub\DNNLikelihood\DNNLikelihood_dev_tutorials\tutorials\toy\toy\data\toy_data.log
    updated (or saved if it did not exist) in 0.004392400000000407 s.

    ==============================
    Added 0 (X_test, Y_test) samples in 0.009593399999999974 s.

    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.008789100000001326 s.

    ==============================
    Idx h5 file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_idx.h5
    updated (or saved if it did not exist) in 0.004162400000012667 s.

    The key &#39;Metrics_on_scaled_data&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;Prediction_time&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;Metrics_on_unscaled_data&#39; was not specified and has been set to the default value &#39;{}&#39;.
    ==============================
    Evaluating all metrics on (scaled) train/val/test using best models

    ==============================
    Evaluating model

    Scaling data.

    20/20 - 0s - loss: 0.7256 - mean_squared_error: 0.5790 - mean_absolute_error: 0.6838 - mean_squared_logarithmic_error: 0.1195 - mean_absolute_percentage_error: 5443.5829 - mean_error: 0.6709
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.009148500000009108 s.

    ==============================
    Evaluating model

    Scaling data.

    6/6 - 0s - loss: 0.7604 - mean_squared_error: 0.6138 - mean_absolute_error: 0.6933 - mean_squared_logarithmic_error: 0.1171 - mean_absolute_percentage_error: 765.2350 - mean_error: 0.6736
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.00920990000000188 s.

    ==============================
    Evaluating model

    Scaling data.

    10/10 - 0s - loss: 0.7351 - mean_squared_error: 0.5885 - mean_absolute_error: 0.6769 - mean_squared_logarithmic_error: 0.1100 - mean_absolute_percentage_error: 494.2122 - mean_error: 0.6477
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.009924600000005057 s.

    ==============================
    Predicting Y for train/val/test samples

    ==============================
    Predicting with Keras model

    Scaling data.

    WARNING:tensorflow:Callbacks method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0010s vs `on_predict_batch_end` time: 0.0080s). Check your callbacks.
    20/20 - 0s
    ==============================
    Predicting with Keras model

    Scaling data.

    WARNING:tensorflow:Callbacks method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0010s vs `on_predict_batch_end` time: 0.0065s). Check your callbacks.
    6/6 - 0s
    ==============================
    Predicting with Keras model

    Scaling data.

    WARNING:tensorflow:Callbacks method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0010s vs `on_predict_batch_end` time: 0.0060s). Check your callbacks.
    10/10 - 0s
    ==============================
    Evaluating all metrics on (un-scaled) trai[timestamp]n/val/test using best models

    ==============================
    Prediction on (10000,3000,5000) (train,val,test) points done in 2.6130508999999904 s.

    ==============================
    Computing Bayesian inference benchmarks

    ==============================
    Computing exp(Y_true) and exp(Y_pred) for train/val/test samples

    ==============================
    Computing weights (pred vs true) for reweighting of distributions

    ==============================
    Computing HPDI (pred vs true) using reweighted distributions

    For some probability values there are different numbers of intervals. In this case error is not computed and is set to None.
    For some probability values there are different numbers of intervals. In this case error is not computed and is set to None.
    For some probability values there are different numbers of intervals. In this case error is not computed and is set to None.
    For some probability values there are different numbers of intervals. In this case error is not computed and is set to None.
    For some probability values there are different numbers of intervals. In this case error is not computed and is set to None.
    The key &#39;HPDI&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;HPDI_error&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;KS&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;KS_medians&#39; was not specified and has been set to the default value &#39;{}&#39;.
    ==============================
    Computing KS test between one-dimensional distributions (pred vs true) using reweighted distributions

    ==============================
    Bayesian inference benchmarks computed in 0.4348025999999834 s.

    ==============================
    Computing Frequentist inference benchmarks based on &#39;frequentist_inference_options&#39;

    ==============================
    A reference Likelihood object is already available. frequentist_inference_options[&quot;input_likelihood_file&quot;] input will be ignored.

    ==============================
    Computing Frequentist inference benchmarks for reference Likelihood

    ==============================
    Computing global maximum for reference Likelihood

    The key &#39;optimizer&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;minimization_options&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;timestamp&#39; was not specified and has been set to the default value &#39;datetime_2021_12_06_16_36_49_9820&#39;.
    The key &#39;save&#39; was not specified and has been set to the default value &#39;False&#39;.
    ==============================
    Computing global maximum
    The key &#39;name&#39; was not specified and has been set to the default value &#39;scipy&#39;.
    The key &#39;args&#39; was not specified and has been set to the default value &#39;[]&#39;.
    The key &#39;kwargs&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;method&#39; was not specified and has been set to the default value &#39;Powell&#39;.
    Maximum logpdf computed in 0.35594520000000784 s.

    ==============================
    Likelihood log file
             C:\Users\Admin\Dropbox\Work\09_Resources\Git\GitHub\DNNLikelihood\DNNLikelihood_dev_tutorials\tutorials\toy\toy\likelihood\toy_likelihood.log
    updated (or saved if it did not exist) in 0.0036088000000233933 s.

    The key &#39;logpdf_max_likelihood&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;datetime_2021_12_06_16_36_49_9820&#39; was not specified and has been set to the default value &#39;{}&#39;.
    ==============================
    Computing profiled maxima for reference Likelihood

    The key &#39;pars_bounds&#39; was not specified and has been set to the default value &#39;None&#39;.
    The key &#39;timestamp&#39; was not specified and has been set to the default value &#39;datetime_2021_12_06_16_36_49_9820&#39;.
    The key &#39;save&#39; was not specified and has been set to the default value &#39;False&#39;.
    ==============================
    Computing profiled maxima
    The key &#39;datetime_2021_12_06_16_36_49_9820&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;args&#39; was not specified and has been set to the default value &#39;[]&#39;.
    The key &#39;kwargs&#39; was not specified and has been set to the default value &#39;{}&#39;.
    Total number of points: 10 .
    Optimizing for parameters: [0]  - values: [0.0] .
    Optimizing for parameters: [0]  - values: [0.1111111111111111] .
    Optimizing for parameters: [0]  - values: [0.2222222222222222] .
    Optimizing for parameters: [0]  - values: [0.3333333333333333] .
    Optimizing for parameters: [0]  - values: [0.4444444444444444] .
    Optimizing for parameters: [0]  - values: [0.5555555555555556] .
    Optimizing for parameters: [0]  - values: [0.6666666666666666] .
    Optimizing for parameters: [0]  - values: [0.7777777777777777] .
    Optimizing for parameters: [0]  - values: [0.8888888888888888] .
    Optimizing for parameters: [0]  - values: [1.0] .
    Computing global maximum to estimate tmu test statistics.
    Maximum logpdf computed in 0.21160299999999665 s.

    ==============================
    Likelihood log file
             C:\Users\Admin\Dropbox\Work\09_Resources\Git\GitHub\DNNLikelihood\DNNLikelihood_dev_tutorials\tutorials\toy\toy\likelihood\toy_likelihood.log
    updated (or saved if it did not exist) in 0.0029160999999930937 s.

    ==============================
    10 local maxima computed in 1.1987985000000094 s.
    Log-pdf values lie in the range [ -57.07828497740044 , -48.11154184674124 ].

    The key &#39;logpdf_profiled_max_likelihood&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;datetime_2021_12_06_16_36_49_9820&#39; was not specified and has been set to the default value &#39;{}&#39;.
    ==============================
    Computing Frequentist inference benchmarks from samples

    ==============================
    Computing global maximum from samples

    The key &#39;timestamp&#39; was not specified and has been set to the default value &#39;datetime_2021_12_06_16_36_49_9820&#39;.
    ==============================
    Computing global maximum from samples

    The key &#39;logpdf_max_sample&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;datetime_2021_12_06_16_36_49_9820&#39; was not specified and has been set to the default value &#39;{}&#39;.
    Maximum of train sample computed in 0.0027992999999923995 s.

    Maximum of val sample computed in 0.0007636999999931504 s.

    Maximum of test sample computed in 0.0007075999999983651 s.

    ==============================
    Computing profiled maxima from samples

    The key &#39;timestamp&#39; was not specified and has been set to the default value &#39;datetime_2021_12_06_16_36_49_9820&#39;.
    ==============================
    Computing profiled maxima from samples

    The key &#39;logpdf_profiled_max_sample&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;datetime_2021_12_06_16_36_49_9820&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;train&#39; was not specified and has been set to the default value &#39;{}&#39;.
    Total number of points: 10 .

    Optimizing for parameters: [0]  - values: [0.0] .
    Optimizing for parameters: [0]  - values: [0.1111111111111111] .
    Optimizing for parameters: [0]  - values: [0.2222222222222222] .
    Optimizing for parameters: [0]  - values: [0.3333333333333333] .
    Optimizing for parameters: [0]  - values: [0.4444444444444444] .
    Optimizing for parameters: [0]  - values: [0.5555555555555556] .
    Optimizing for parameters: [0]  - values: [0.6666666666666666] .
    Optimizing for parameters: [0]  - values: [0.7777777777777777] .
    Optimizing for parameters: [0]  - values: [0.8888888888888888] .
    Optimizing for parameters: [0]  - values: [1.0] .
    ==============================
    Profiled maxima of train sample for 10 points computed in 20.895175999999992 s.

    The key &#39;val&#39; was not specified and has been set to the default value &#39;{}&#39;.
    Total number of points: 10 .

    Optimizing for parameters: [0]  - values: [0.0] .
    Optimizing for parameters: [0]  - values: [0.1111111111111111] .
    Optimizing for parameters: [0]  - values: [0.2222222222222222] .
    Optimizing for parameters: [0]  - values: [0.3333333333333333] .
    Optimizing for parameters: [0]  - values: [0.4444444444444444] .
    Optimizing for parameters: [0]  - values: [0.5555555555555556] .
    Optimizing for parameters: [0]  - values: [0.6666666666666666] .
    Optimizing for parameters: [0]  - values: [0.7777777777777777] .
    Optimizing for parameters: [0]  - values: [0.8888888888888888] .
    Optimizing for parameters: [0]  - values: [1.0] .
    ==============================
    Profiled maxima of val sample for 10 points computed in 9.414752099999987 s.

    The key &#39;test&#39; was not specified and has been set to the default value &#39;{}&#39;.
    Total number of points: 10 .

    Optimizing for parameters: [0]  - values: [0.0] .
    Optimizing for parameters: [0]  - values: [0.1111111111111111] .
    Optimizing for parameters: [0]  - values: [0.2222222222222222] .
    Optimizing for parameters: [0]  - values: [0.3333333333333333] .
    Optimizing for parameters: [0]  - values: [0.4444444444444444] .
    Optimizing for parameters: [0]  - values: [0.5555555555555556] .
    Optimizing for parameters: [0]  - values: [0.6666666666666666] .
    Optimizing for parameters: [0]  - values: [0.7777777777777777] .
    Optimizing for parameters: [0]  - values: [0.8888888888888888] .
    Optimizing for parameters: [0]  - values: [1.0] .
    ==============================
    Profiled maxima of test sample for 10 points computed in 11.582379799999984 s.

    ==============================
    Computing Frequentist inference benchmarks from model

    ==============================
    Computing global maximum from model

    The key &#39;timestamp&#39; was not specified and has been set to the default value &#39;datetime_2021_12_06_16_36_49_9820&#39;.
    The key &#39;save&#39; was not specified and has been set to the default value &#39;False&#39;.
    ==============================
    Computing global maximum of Keras model

    The key &#39;logpdf_max_model&#39; was not specified and has been set to the default value &#39;{}&#39;.
    ==============================
    Optimizing with tensorflow

    Step: 0 Value: -52.750979833311696 -- Step: 100 Value: -49.23497556652939 -- % Variation 0.06665287124319885
    Step: 100 Value: -49.23497556652939 -- Step: 200 Value: -47.80273714378706 -- % Variation 0.02908985748976354
    Step: 200 Value: -47.80273714378706 -- Step: 300 Value: -49.63739609127204 -- % Variation -0.038379788629392876
    Optimizer learning rate reduced from 1 to 0.5 .

    Step: 300 Value: -49.63739609127204 -- Step: 400 Value: -47.11896891766499 -- % Variation 0.050736488452702504
    Step: 400 Value: -47.11896891766499 -- Step: 500 Value: -47.3104310603121 -- % Variation -0.004063377171551919
    Optimizer learning rate reduced from 0.5 to 0.25 .

    Step: 500 Value: -47.3104310603121 -- Step: 600 Value: -46.99135095258422 -- % Variation 0.006744392316381758
    Step: 600 Value: -46.99135095258422 -- Step: 700 Value: -46.788951647372606 -- % Variation 0.0043071608095677305
    Step: 700 Value: -46.788951647372606 -- Step: 800 Value: -46.802268199895074 -- % Variation -0.0002846089098731946
    Optimizer learning rate reduced from 0.25 to 0.125 .

    Step: 800 Value: -46.802268199895074 -- Step: 900 Value: -46.84494452263145 -- % Variation -0.0009118430447452572
    Optimizer learning rate reduced from 0.125 to 0.0625 .

    Step: 900 Value: -46.84494452263145 -- Step: 1000 Value: -46.6758648175949 -- % Variation 0.0036093479618674114
    Step: 1000 Value: -46.6758648175949 -- Step: 1100 Value: -46.67349168996511 -- % Variation 5.0842713660732376e-05
    Converged to tolerance 0.0001 in 3.7045769000000064 s.

    Best tolerance 5.0842713660732376e-05 reached in 3.7076693000000205 s.

    ==============================
    Maximum of DNN computed in 3.7076693000000205 s.

    ==============================
    Computing profiled maxima from model

    The key &#39;timestamp&#39; was not specified and has been set to the default value &#39;datetime_2021_12_06_16_36_49_9820&#39;.
    ==============================
    Computing profiled maxima of Keras model

    Total number of points: 10 .

    The key &#39;logpdf_profiled_max_model&#39; was not specified and has been set to the default value &#39;{}&#39;.
    The key &#39;datetime_2021_12_06_16_36_49_9820&#39; was not specified and has been set to the default value &#39;{}&#39;.
    Optimizing for parameters: [0]  - values: [0.0] .
    Optimizing for parameters: [0]  - values: [0.1111111111111111] .
    Optimizing for parameters: [0]  - values: [0.2222222222222222] .
    Optimizing for parameters: [0]  - values: [0.3333333333333333] .
    Optimizing for parameters: [0]  - values: [0.4444444444444444] .
    Optimizing for parameters: [0]  - values: [0.5555555555555556] .
    Optimizing for parameters: [0]  - values: [0.6666666666666666] .
    Optimizing for parameters: [0]  - values: [0.7777777777777777] .
    Optimizing for parameters: [0]  - values: [0.8888888888888888] .
    Optimizing for parameters: [0]  - values: [1.0] .

    ==============================
    Profiled maxima of DNN for 10 points computed in 614.4056245 s.

    ==============================
    Frequentist inference benchmarks computed in 661.5934887999999 s.

    ==============================
    The file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_predictions.json
    already exists and has been moved to
             &lt;abs_path_to_output_folder&gt;\old_2021_12_06_16_48_13_1074_DNNLikelihood_toy_predictions.json

    ==============================
    Predictions json file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_predictions.json
    saved in 0.0268781999999419 s.

    ==============================
    The file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_predictions.h5
    already exists and has been moved to
             &lt;abs_path_to_output_folder&gt;\old_2021_12_06_16_48_13_1354_DNNLikelihood_toy_predictions.h5

    ==============================
    Predictions h5 file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_predictions.h5
    saved in 0.0869822000000795 s.

    ==============================
    Making plots for model evaluation

    ==============================
    Plotting training history

    Checking and updating figures dictionary

    &lt;image1&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_training_history_loss.pdf
    created and saved in 11.569495599999982 s.

    Checking and updating figures dictionary

    &lt;image2&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_training_history_mean_error.pdf
    created and saved in 2.2338313999999855 s.

    ==============================
    Plotting parameters coverage

    ==============================
    Predicting with Keras model

    Scaling data.

    2/2 - 0s
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.010870199999999386 s.

    Checking and updating figures dictionary

    &lt;image3&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_par_lik_coverage_0.pdf
    created and saved in 3.837169200000062 s.

    ==============================
    Predicting with Keras model

    Scaling data.

    2/2 - 0s
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.011883099999977276 s.

    Checking and updating figures dictionary

    &lt;image4&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_par_lik_coverage_2.pdf
    created and saved in 0.8404969000000619 s.

    ==============================
    Predicting with Keras model

    Scaling data.

    2/2 - 0s
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.00968399999999292 s.

    Checking and updating figures dictionary

    &lt;image5&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_par_lik_coverage_4.pdf
    created and saved in 0.8441845000000967 s.

    ==============================
    Predicting with Keras model

    Scaling data.

    2/2 - 0s
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.00970319999998992 s.

    Checking and updating figures dictionary

    &lt;image6&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_par_lik_coverage_5.pdf
    created and saved in 0.7553292000000056 s.

    ==============================
    Predicting with Keras model

    Scaling data.

    2/2 - 0s
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.009699800000021241 s.

    Checking and updating figures dictionary

    &lt;image7&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_par_lik_coverage_8.pdf
    created and saved in 0.7887908000000152 s.

    ==============================
    Plotting likelihood distribution

    Checking and updating figures dictionary
    ==============================
    Predicting with Keras model

    Scaling data.

    10/10 - 0s
    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    updated (or saved if it did not exist) in 0.010957399999938389 s.

    Checking and updating figures dictionary

    &lt;image8&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_lik_distribution.pdf
    created and saved in 0.8909048000000439 s.

    ==============================
    Making corner plots for Bayesian inference

    ==============================
    Plotting 2d posterior distributions for single sample

    Checking and updating figures dictionary

    &lt;image9&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_train_true.pdf
    created and saved in 7.74165359999995 s.

    ==============================
    Plotting 2d posterior distributions for single sample

    Checking and updating figures dictionary

    &lt;image10&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_train_pred.pdf
    created and saved in 3.298143200000027 s.

    ==============================
    Plotting 2d posterior distributions for single sample

    Checking and updating figures dictionary

    &lt;image11&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_val_true.pdf
    created and saved in 3.204072300000007 s.

    ==============================
    Plotting 2d posterior distributions for single sample

    Checking and updating figures dictionary

    &lt;image12&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_val_pred.pdf
    created and saved in 3.083647199999973 s.

    ==============================
    Plotting 2d posterior distributions for single sample

    Checking and updating figures dictionary

    &lt;image13&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_test_true.pdf
    created and saved in 3.5541520000000446 s.

    ==============================
    Plotting 2d posterior distributions for single sample

    Checking and updating figures dictionary

    &lt;image14&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_test_pred.pdf
    created and saved in 3.499598399999968 s.

    ==============================
    Plotting 2d posterior distributions for two samples comparison

    Checking and updating figures dictionary

    &lt;image15&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_train_true_vs_train_pred.pdf
    created and saved in 4.314005199999997 s.

    ==============================
    Plotting 2d posterior distributions for two samples comparison

    Checking and updating figures dictionary

    &lt;image16&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_test_true_vs_test_pred.pdf
    created and saved in 4.048993200000041 s.

    ==============================
    Plotting 2d posterior distributions for two samples comparison

    Checking and updating figures dictionary

    &lt;image17&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_corner_pars_train_true_vs_test_pred.pdf
    created and saved in 3.716974300000061 s.

    ==============================
    Making t_mu plot for Frequentist inference

    ==============================
    Plotting t_mu test statistics

    t_mu information for source &#39;model&#39; is not available. The curve will not be included in the plot.
    Checking and updating figures dictionary

    &lt;image18&gt;

    ==============================
    Figure file
             DNNLikelihood_toy_figure_tmu_0.pdf
    created and saved in 0.49693549999994957 s.

    ==============================
    All plots done in 58.75557929999991 s.

    ==============================
    Idx h5 file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_idx.h5
    saved in 0.007333099999982551 s.

    ==============================
    Model json file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_model.json
    saved in 0.00832470000000285 s.

    ==============================
    Model h5 file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_model.h5
    tf executing eager_mode: True
    INFO:tf2onnx:tf executing eager_mode: True
    tf.keras model eager_mode: False
    INFO:tf2onnx:tf.keras model eager_mode: False

    saved in 0.16234810000003108 s.


    The ONNX operator number change on the optimization: 35 -&gt; 25
    INFO:tf2onnx:The ONNX operator number change on the optimization: 35 -&gt; 25
    WARNING:onnxmltools:The maximum opset needed by this model is only 9.
    ==============================
    Model onnx file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_model.onnx
    saved in 4.907806100000016 s.

    ==============================
    Model history file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_history.json
    saved in 0.008585899999957292 s.

    ==============================
    Predictions json file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_predictions.json
    saved in 0.09338190000005397 s.

    ==============================
    Predictions h5 file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_predictions.h5
    saved in 0.10175609999998869 s.

    ==============================
    \nJson file\n\t
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_summary.json
    saved in 0.007870599999932892 s.

    ==============================
    Scalers pickle file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_scalers.pickle
    saved in 0.004544399999986126 s.

    ==============================
    Model graph pdf file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy_model_graph.pdf
    saved in 3.346568599999955 s.

    ==============================
    DnnLik log file
             &lt;abs_path_to_output_folder&gt;\DNNLikelihood_toy.log
    saved in 0.014863800000057381 s.

    ==============================
    All predictions computed in 741.998475 s.
</pre></div>
</div>
<p>where &lt;image1&gt; to &lt;image18&gt; correspond to the following figures:</p>
<a class="with-shadow reference internal image-reference" href="../_images/image1.png"><img alt="../_images/image1.png" class="with-shadow" src="../_images/image1.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image2.png"><img alt="../_images/image2.png" class="with-shadow" src="../_images/image2.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image3.png"><img alt="../_images/image3.png" class="with-shadow" src="../_images/image3.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image4.png"><img alt="../_images/image4.png" class="with-shadow" src="../_images/image4.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image5.png"><img alt="../_images/image5.png" class="with-shadow" src="../_images/image5.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image6.png"><img alt="../_images/image6.png" class="with-shadow" src="../_images/image6.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image7.png"><img alt="../_images/image7.png" class="with-shadow" src="../_images/image7.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image8.png"><img alt="../_images/image8.png" class="with-shadow" src="../_images/image8.png" style="width: 339.66px; height: 253.8px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image9.png"><img alt="../_images/image9.png" class="with-shadow" src="../_images/image9.png" style="width: 788.94px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image10.png"><img alt="../_images/image10.png" class="with-shadow" src="../_images/image10.png" style="width: 788.94px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image11.png"><img alt="../_images/image11.png" class="with-shadow" src="../_images/image11.png" style="width: 785.7px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image12.png"><img alt="../_images/image12.png" class="with-shadow" src="../_images/image12.png" style="width: 785.7px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image13.png"><img alt="../_images/image13.png" class="with-shadow" src="../_images/image13.png" style="width: 786.7800000000001px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image14.png"><img alt="../_images/image14.png" class="with-shadow" src="../_images/image14.png" style="width: 786.7800000000001px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image15.png"><img alt="../_images/image15.png" class="with-shadow" src="../_images/image15.png" style="width: 788.94px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image16.png"><img alt="../_images/image16.png" class="with-shadow" src="../_images/image16.png" style="width: 786.7800000000001px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image17.png"><img alt="../_images/image17.png" class="with-shadow" src="../_images/image17.png" style="width: 788.94px; height: 778.1400000000001px;" /></a>
<a class="with-shadow reference internal image-reference" href="../_images/image18.png"><img alt="../_images/image18.png" class="with-shadow" src="../_images/image18.png" style="width: 340.20000000000005px; height: 253.8px;" /></a>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="class.html" class="btn btn-neutral float-right" title="Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="DNNLik object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Andrea Coccaro; Maurizio Pierini; Luca Silvestrini; Riccardo Torre

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>