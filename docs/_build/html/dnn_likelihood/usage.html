

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Usage &mdash; DNNLikelihood</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.2/gh-fork-ribbon.min.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Class" href="class.html" />
    <link rel="prev" title="The DNNLikelihood object" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> DNNLikelihood
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../code.html">Python module</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../summary.html">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../histfactory/index.html">The Histfactory object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../likelihood/index.html">The Likelihood object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sampler/index.html">The Sampler object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">The Data object</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">The DNNLikelihood object</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="class.html">Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dnn_likelihood_ensemble/index.html">The DnnLikEnsemble object</a></li>
<li class="toctree-l2"><a class="reference internal" href="../resources/index.html">Resources management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../inference.html">Inference functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">Useful functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../corner.html">Notes on corner.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plots.html">Notes on plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../show_prints.html">Verbosity mode</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../citations.html">Use and Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indices_tables.html">Indices</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DNNLikelihood</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../code.html">Python module</a> &raquo;</li>
        
          <li><a href="index.html">The DNNLikelihood object</a> &raquo;</li>
        
      <li>Usage</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/dnn_likelihood/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="usage">
<span id="dnnlik-usage"></span><h1>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">Â¶</a></h1>
<p>We give here a brief introduction to the use of the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> class. Refer to the
full class documentation for more details. All examples will be referred to the toy likelihood introduced in
<a class="reference internal" href="../likelihood/usage.html#likelihood-usage"><span class="std std-ref">the Likelihood object Usage</span></a> section of the documentation.</p>
<p>A <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is defined through a series of dictionaries (or lists of dictionaries) describing data,
DNN input parameters, DNN optimizer, DNN compilation parameters, training callbacks parameters, and DNN training parameters.
An example of the dictionaries defining the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> configurations is given by</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model_data_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;npoints&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
                 <span class="s2">&quot;scalerX&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="s2">&quot;scalerY&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                 <span class="s2">&quot;weighted&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="n">model_define_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;hidden_layers&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;selu&quot;</span><span class="p">],</span>
                                         <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;relu&quot;</span><span class="p">],</span>
                                         <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;selu&quot;</span><span class="p">,</span> <span class="s2">&quot;lecun_normal&quot;</span><span class="p">],</span>
                                         <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span> <span class="s2">&quot;glorot_uniform&quot;</span><span class="p">]],</span>
                       <span class="s2">&quot;act_func_out_layer&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                       <span class="s2">&quot;dropout_rate&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="s2">&quot;batch_norm&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="n">model_optimizer_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Adam&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;learning_rate&quot;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
                          <span class="s2">&quot;beta_1&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
                          <span class="s2">&quot;beta_2&quot;</span><span class="p">:</span> <span class="mf">0.999</span><span class="p">,</span>
                          <span class="s2">&quot;amsgrad&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="n">model_compile_inputs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="s2">&quot;mse&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean_squared_error&quot;</span><span class="p">,</span> <span class="s2">&quot;mae&quot;</span><span class="p">,</span> <span class="s2">&quot;msle&quot;</span><span class="p">,</span> <span class="s2">&quot;me&quot;</span><span class="p">]}</span>
<span class="n">model_callbacks_inputs</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;EarlyStopping&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;loss&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;patience&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                           <span class="s2">&quot;min_delta&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span>
                           <span class="s2">&quot;restore_best_weights&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                          <span class="s2">&quot;TerminateOnNaN&quot;</span><span class="p">,</span>
                          <span class="s2">&quot;PlotLossesKeras&quot;</span><span class="p">,</span>
                          <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ReduceLROnPlateau&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;loss&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;factor&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
                           <span class="s2">&quot;min_lr&quot;</span><span class="p">:</span> <span class="mf">0.00008</span><span class="p">,</span>
                           <span class="s2">&quot;patience&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                           <span class="s2">&quot;min_delta&quot;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">},</span>
                          <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;ModelCheckpoint&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="s2">&quot;automatically set by the framework&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;loss&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;min&quot;</span><span class="p">,</span>
                           <span class="s2">&quot;save_best_only&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                           <span class="s2">&quot;save_freq&quot;</span><span class="p">:</span> <span class="s2">&quot;epoch&quot;</span><span class="p">}]</span>
<span class="n">model_train_inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;epochs&quot;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
                    <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">}</span>
</pre></div>
</div>
<p>Each of the dictionaries is an input argument of the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> class (see the corresponding
documentation pages for a complete documentation:
<a class="reference internal" href="arguments.html#DnnLik.model_data_inputs" title="DnnLik.model_data_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_data_inputs</span></code></a>, <a class="reference internal" href="arguments.html#DnnLik.model_define_inputs" title="DnnLik.model_define_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_define_inputs</span></code></a>,
<a class="reference internal" href="arguments.html#DnnLik.model_optimizer_inputs" title="DnnLik.model_optimizer_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_optimizer_inputs</span></code></a>, <a class="reference internal" href="arguments.html#DnnLik.model_compile_inputs" title="DnnLik.model_compile_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_compile_inputs</span></code></a>,
<a class="reference internal" href="arguments.html#DnnLik.model_callbacks_inputs" title="DnnLik.model_callbacks_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_callbacks_inputs</span></code></a>, <a class="reference internal" href="arguments.html#DnnLik.model_train_inputs" title="DnnLik.model_train_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_train_inputs</span></code></a>).</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_data_inputs" title="DnnLik.model_data_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_data_inputs</span></code></a> dictionary contains information about the way data are processed
by the DNN. In particular it specifies the number of points for training, validation, and test, if <code class="docutils literal notranslate"><span class="pre">X</span></code> and/or <code class="docutils literal notranslate"><span class="pre">Y</span></code> data
need to be scaled through a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html"  target="_blank"> StandardScalers</a> and if <code class="docutils literal notranslate"><span class="pre">Y</span></code> data need to be weighted. These parameters are passed to the
<a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> container class that is automatically instantiated by the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a>
one and that is used for data management.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_define_inputs" title="DnnLik.model_define_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_define_inputs</span></code></a> dictionary contains the main hyperparameters needed to define
the DNN. They are given by the scruture of hidden layers each of which with number of nodes, activation function, and layer initialization,
the activation function in the last layer, the amount of dropout, the batch normalization option, and so on (in general all arguments
taken by the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"  target="_blank"> tf.keras.Model</a> class).</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_optimizer_inputs" title="DnnLik.model_optimizer_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_optimizer_inputs</span></code></a> dictionary is devoted to the definition of the optimizer.
The optimizer name is defined by the <code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code> key. All <a href="https://www.tensorflow.org/api_docs/python/tf/keras/optimizers"  target="_blank"> tf.keras.optimizers</a> are supported and all optimizers arguments are
passed by the remaining items in the dictionary.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.model_compile_inputs" title="DnnLik.model_compile_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_compile_inputs</span></code></a> dictionary defines inputs for the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#compile"  target="_blank"> tf.keras.Model.compile</a>
class. The loss is passed through its name (in case of a custom loss its name need to be defined within the framework) and the metrics
that the user is interested in monitoring are passed through a list of names. Names can be passed in all formats supported by <a href="https://www.tensorflow.org/api_docs/python/tf/keras"  target="_blank"> tf.keras</a>.</p>
<p>Callbacks are passed through the list of dictionaries <a class="reference internal" href="arguments.html#DnnLik.model_callbacks_inputs" title="DnnLik.model_callbacks_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_callbacks_inputs</span></code></a>. All
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks"  target="_blank"> tf.keras.callbacks</a> are supported. One can add them just by adding their name to the list, to pass it with default arguments,
or by a dictionary containing the <code class="docutils literal notranslate"><span class="pre">&quot;name&quot;</span></code> item and all other arguments supported by that callback.</p>
<p>Finally, the <a class="reference internal" href="arguments.html#DnnLik.model_train_inputs" title="DnnLik.model_train_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">model_train_inputs</span></code></a> dictionary is used to pass parameters, such as the number of
epochs and the batch size, to the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"  target="_blank"> tf.keras.Model.fit</a> method.</p>
<p>The <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object can be instantiated in three different ways, depending on the value of the arguments
<a class="reference internal" href="arguments.html#DnnLik.data" title="DnnLik.data"><code class="xref py py-argument docutils literal notranslate"><span class="pre">data</span></code></a>, <code class="xref py py-argument docutils literal notranslate"><span class="pre">input_data_file</span></code>,
and <a class="reference internal" href="arguments.html#DnnLik.input_summary_json_file" title="DnnLik.input_summary_json_file"><code class="xref py py-argument docutils literal notranslate"><span class="pre">input_data_file</span></code></a>. The latter argument determines whether a new object is created from
input arguments (when is set to <code class="docutils literal notranslate"><span class="pre">None</span></code>) or the object is imported from a previously saved one (when is set to the corresponding
path). When a new object is created, data can be passed both through an already defined <a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object
or through the path to a previously saved one. If the path is passed, then it is always used and, if a the locally defined
<a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> is passed, it gets ignored.</p>
<p>Starting from the data object we have saved in <a class="reference internal" href="../data/usage.html#data-usage"><span class="std std-ref">the Data object Usage</span></a> section of the documentation,
and using the arguments defined above, we can create a <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span> <span class="o">=</span> <span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">DnnLik</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;DNNLikelihood_toy&quot;</span><span class="p">,</span>
                                     <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">input_data_file</span><span class="o">=</span><span class="s2">&quot;toy/data/toy_data&quot;</span><span class="p">,</span>
                                     <span class="n">load_on_RAM</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                     <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">same_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                     <span class="n">model_data_inputs</span><span class="o">=</span><span class="n">model_data_inputs</span><span class="p">,</span>
                                     <span class="n">model_define_inputs</span><span class="o">=</span><span class="n">model_define_inputs</span><span class="p">,</span>
                                     <span class="n">model_optimizer_inputs</span><span class="o">=</span><span class="n">model_optimizer_inputs</span><span class="p">,</span>
                                     <span class="n">model_compile_inputs</span><span class="o">=</span><span class="n">model_compile_inputs</span><span class="p">,</span>
                                     <span class="n">model_callbacks_inputs</span><span class="o">=</span><span class="n">model_callbacks_inputs</span><span class="p">,</span>
                                     <span class="n">model_train_inputs</span><span class="o">=</span><span class="n">model_train_inputs</span><span class="p">,</span>
                                     <span class="n">resources_inputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">output_folder</span><span class="o">=</span><span class="s2">&quot;toy/dnnlikelihood&quot;</span><span class="p">,</span>
                                     <span class="n">ensemble_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">input_summary_json_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="s1">&#39;standalone&#39;</span> <span class="n">DNNLikelihood</span> <span class="ow">and</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">belong</span> <span class="n">to</span> <span class="n">a</span> <span class="n">DNNLikelihood_ensemble</span><span class="o">.</span> <span class="n">The</span> <span class="n">attributes</span> <span class="s1">&#39;ensemble_name&#39;</span> <span class="ow">and</span> <span class="s1">&#39;ensemble_folder&#39;</span> <span class="n">are</span> <span class="n">therefore</span> <span class="n">been</span> <span class="nb">set</span> <span class="n">to</span> <span class="kc">None</span><span class="o">.</span>
    <span class="mi">88</span> <span class="n">CPU</span> <span class="n">cores</span> <span class="n">available</span>
    <span class="mi">2</span> <span class="n">GPUs</span> <span class="n">available</span>
    <span class="mi">2</span> <span class="n">GPUs</span> <span class="n">have</span> <span class="n">been</span> <span class="nb">set</span><span class="p">:</span>
    <span class="p">[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;/device:GPU:1&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:af:00.0, compute capability: 7.5&#39;</span><span class="p">]</span> <span class="o">.</span>
    <span class="n">Data</span> <span class="nb">object</span> <span class="n">loaded</span> <span class="ow">in</span> <span class="mf">0.01676490000000186</span> <span class="o">.</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_input_data_file</span><span class="o">&gt;.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.0028986999999993657</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Optimizer</span> <span class="nb">set</span> <span class="n">to</span><span class="p">:</span> <span class="n">optimizers</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">beta_1</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">beta_2</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">amsgrad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">Loss</span> <span class="nb">set</span> <span class="n">to</span><span class="p">:</span> <span class="n">mse</span>
    <span class="n">Setting</span> <span class="n">metrics</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">mean_squared_error</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">mae</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">msle</span>
            <span class="n">Added</span> <span class="n">metric</span><span class="p">:</span> <span class="n">me</span>
    <span class="n">Setting</span> <span class="n">callbacks</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">TerminateOnNaN</span><span class="p">()</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">PlotLossesKeras</span><span class="p">()</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">restore_best_weights</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span><span class="p">(</span><span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">min_lr</span><span class="o">=</span><span class="mf">8e-05</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>
            <span class="n">Added</span> <span class="n">callback</span><span class="p">:</span> <span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;\checkpoints\DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s1">-</span><span class="si">{val_loss:.2f}</span><span class="s1">.h5&#39;</span><span class="p">,</span> <span class="n">monitor</span><span class="o">=</span><span class="s1">&#39;val_loss&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_freq</span><span class="o">=</span><span class="s1">&#39;epoch&#39;</span><span class="p">)</span>
    <span class="n">DnnLik</span> <span class="n">json</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_summary</span><span class="o">.</span><span class="n">json</span> <span class="n">saved</span> <span class="ow">in</span> <span class="mf">0.0027066999999973973</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">saved</span> <span class="ow">in</span> <span class="mf">0.0014132999999993956</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>where we used the placeholders &lt;abs_path_to_input_data_file&gt; and &lt;abs_path_to_output_folder&gt; to indicate the absolute path  to
<code class="docutils literal notranslate"><span class="pre">input_data_file</span></code> and <code class="docutils literal notranslate"><span class="pre">output_folder</span></code>.</p>
<p>If the <a class="reference internal" href="arguments.html#DnnLik.name" title="DnnLik.name"><code class="xref py py-argument docutils literal notranslate"><span class="pre">name</span></code></a> argument is not passed, then one is automatically generated.
The <a class="reference internal" href="arguments.html#DnnLik.load_on_RAM" title="DnnLik.load_on_RAM"><code class="xref py py-argument docutils literal notranslate"><span class="pre">load_on_RAM</span></code></a> argument is passed directly to the <a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object (see the
documentation of <a class="reference internal" href="../data/arguments.html#Data.load_on_RAM" title="Data.load_on_RAM"><code class="xref py py-argument docutils literal notranslate"><span class="pre">Data.load_on_RAM</span></code></a>). The <a class="reference internal" href="arguments.html#DnnLik.seed" title="DnnLik.seed"><code class="xref py py-argument docutils literal notranslate"><span class="pre">seed</span></code></a> argument is used to
initialize the <a href="https://docs.scipy.org/doc/numpy/index.html"  target="_blank"> numpy</a> and <a href="https://www.tensorflow.org/"  target="_blank"> TensorFlow</a> random number generators. The <a class="reference internal" href="arguments.html#DnnLik.output_folder" title="DnnLik.output_folder"><code class="xref py py-argument docutils literal notranslate"><span class="pre">output_folder</span></code></a> argument
is specified as usual, with a relative or absolute path, and if left unspecified, it is automatically set to the current working
directory.</p>
<p>The <a class="reference internal" href="arguments.html#DnnLik.same_data" title="DnnLik.same_data"><code class="xref py py-argument docutils literal notranslate"><span class="pre">same_data</span></code></a> and <a class="reference internal" href="arguments.html#DnnLik.ensemble_name" title="DnnLik.ensemble_name"><code class="xref py py-argument docutils literal notranslate"><span class="pre">ensemble_name</span></code></a> arguments
should not be specified by the user (or left <code class="docutils literal notranslate"><span class="pre">None</span></code>) and are automatically passed in case the
<a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is part of a <a class="reference internal" href="../dnn_likelihood_ensemble/index.html#module-dnn_likelihood_ensemble" title="dnn_likelihood_ensemble"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DNNLikEnsemble</span></code></a>.</p>
<p>When the object is created, resources are allocated through the hinerithed class <a class="reference internal" href="../resources/class.html#DNNLikelihood.Resources" title="DNNLikelihood.Resources"><code class="xref py py-class docutils literal notranslate"><span class="pre">Resources</span></code></a> (
see <a class="reference internal" href="../resources/index.html#resources-module"><span class="std std-ref">Resources management</span></a> for details). The <a class="reference internal" href="arguments.html#DnnLik.resources_inputs" title="DnnLik.resources_inputs"><code class="xref py py-argument docutils literal notranslate"><span class="pre">datresources_inputsa</span></code></a>
should not be specified by the user (or left <code class="docutils literal notranslate"><span class="pre">None</span></code>) since it is only used for automatic resources allocation when the object is part
of a <a class="reference internal" href="../dnn_likelihood_ensemble/index.html#module-dnn_likelihood_ensemble" title="dnn_likelihood_ensemble"><code class="xref py py-mod docutils literal notranslate"><span class="pre">DNNLikEnsemble</span></code></a> object.</p>
<p>The <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.__init__" title="DNNLikelihood.DnnLik.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.__init__</span></code></a> method sets several attributes, which can be seen in the following output:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="vm">__dict__</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="s1">&#39;active_gpus&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:1&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:af:00.0, compute capability: 7.5&#39;</span><span class="p">]]]</span>
    <span class="p">[</span><span class="s1">&#39;act_func_out_layer&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;available_cpu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;/device:CPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;Intel(R) Xeon(R) Gold 6152 CPU @ 2.10GHz&#39;</span><span class="p">,</span> <span class="mi">88</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;available_gpus&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:1&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 1, name: GeForce RTX 2080 Ti, pci bus id: 0000:af:00.0, compute capability: 7.5&#39;</span><span class="p">]]]</span>
    <span class="p">[</span><span class="s1">&#39;batch_norm&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;batch_size&#39;</span><span class="p">,</span> <span class="mi">512</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;callbacks&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">TerminateOnNaN</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E48B2F5B0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">livelossplot</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">tf_keras</span><span class="o">.</span><span class="n">PlotLossesCallback</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E48B2F700</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E48B2F520</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ReduceLROnPlateau</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E5400CBE0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E5404FFD0</span><span class="o">&gt;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;callbacks_strings&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;callbacks.TerminateOnNaN()&#39;</span><span class="p">,</span> <span class="s1">&#39;PlotLossesKeras()&#39;</span><span class="p">,</span> <span class="s2">&quot;callbacks.EarlyStopping(monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, patience=100, min_delta=0.0001, restore_best_weights=True)&quot;</span><span class="p">,</span> <span class="s2">&quot;callbacks.ReduceLROnPlateau(monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, factor=0.2, min_lr=8e-05, patience=10, min_delta=0.0001)&quot;</span><span class="p">,</span> <span class="s2">&quot;callbacks.ModelCheckpoint(filepath = r&#39;&lt;abs_path_to_output_folder&gt;/checkpoints/DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s2">-</span><span class="si">{val_loss:.2f}</span><span class="s2">.h5&#39;, monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, save_best_only=True, save_freq=&#39;epoch&#39;)&quot;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E5404FE80</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;dropout_rate&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;float64&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;ensemble_folder&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;ensemble_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;epochs_available&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;epochs_required&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;figures_list&#39;</span><span class="p">,</span> <span class="p">[]]</span>
    <span class="p">[</span><span class="s1">&#39;gpu_mode&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;hidden_layers&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;selu&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span> <span class="s1">&#39;lecun_normal&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">]]]</span>
    <span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">,</span> <span class="p">{}]</span>
    <span class="p">[</span><span class="s1">&#39;idx_test&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;idx_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;idx_val&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int32</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;input_data_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_input_data_file&gt;&#39;</span>
    <span class="p">[</span><span class="s1">&#39;input_files_base_name&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_history_json_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_idx_h5_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_log_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_predictions_h5_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_scalers_pickle_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_summary_json_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;input_tf_model_h5_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;load_on_RAM&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;2021-01-29-09-13-49.9946&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;created&#39;</span><span class="p">},</span> <span class="s1">&#39;2021-01-29-09-13-55.4107&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;metrics set&#39;</span><span class="p">,</span> <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;msle&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]},</span> <span class="s1">&#39;2021-01-29-09-13-55.4177&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;callbacks set&#39;</span><span class="p">,</span> <span class="s1">&#39;callbacks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;callbacks.TerminateOnNaN()&#39;</span><span class="p">,</span> <span class="s1">&#39;PlotLossesKeras()&#39;</span><span class="p">,</span> <span class="s2">&quot;callbacks.EarlyStopping(monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, patience=100, min_delta=0.0001, restore_best_weights=True)&quot;</span><span class="p">,</span> <span class="s2">&quot;callbacks.ReduceLROnPlateau(monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, factor=0.2, min_lr=8e-05, patience=10, min_delta=0.0001)&quot;</span><span class="p">,</span> <span class="s2">&quot;callbacks.ModelCheckpoint(filepath = r&#39;&lt;abs_path_to_output_folder&gt;/checkpoints/DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s2">-</span><span class="si">{val_loss:.2f}</span><span class="s2">.h5&#39;, monitor=&#39;val_loss&#39;, mode=&#39;min&#39;, save_best_only=True, save_freq=&#39;epoch&#39;)&quot;</span><span class="p">]},</span> <span class="s1">&#39;2021-01-29-09-13-55.4227&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;saved summary json&#39;</span><span class="p">,</span> <span class="s1">&#39;file name&#39;</span><span class="p">:</span> <span class="s1">&#39;DNNLikelihood_toy_summary.json&#39;</span><span class="p">,</span> <span class="s1">&#39;file path&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_summary.json&#39;</span><span class="p">}}]</span>
    <span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">mean_squared_error</span> <span class="n">at</span> <span class="mh">0x0000029E4D0FC4C0</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;loss_string&#39;</span><span class="p">,</span> <span class="s1">&#39;mse&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;metrics&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">function</span> <span class="n">mean_squared_error</span> <span class="n">at</span> <span class="mh">0x0000029E4D0FC4C0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">mean_absolute_error</span> <span class="n">at</span> <span class="mh">0x0000029E4D0FC5E0</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">mean_squared_logarithmic_error</span> <span class="n">at</span> <span class="mh">0x0000029E4D0FC820</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">DnnLik</span><span class="o">.</span><span class="n">mean_error</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">dnn_likelihood</span><span class="o">.</span><span class="n">DnnLik</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E5404FCD0</span><span class="o">&gt;&gt;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;metrics_string&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;msle&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;DNNLikelihood_toy&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;ndims&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_available&#39;</span><span class="p">,</span> <span class="mi">200000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_test&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_test_available&#39;</span><span class="p">,</span> <span class="mi">60000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_train&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_train_val_available&#39;</span><span class="p">,</span> <span class="mi">140000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;npoints_val&#39;</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">tensorflow</span><span class="o">.</span><span class="n">python</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">optimizer_v2</span><span class="o">.</span><span class="n">adam</span><span class="o">.</span><span class="n">Adam</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x0000029E48B2B250</span><span class="o">&gt;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;optimizer_string&#39;</span><span class="p">,</span> <span class="s1">&#39;optimizers.Adam(learning_rate=0.001, beta_1=0.9, beta_2=0.999, amsgrad=False)&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_checkpoints_files&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/checkpoints/DNNLikelihood_toy_checkpoint.</span><span class="si">{epoch:02d}</span><span class="s1">-</span><span class="si">{val_loss:.2f}</span><span class="s1">.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_checkpoints_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/checkpoints&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figures_base_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/figures/DNNLikelihood_toy_figure&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figures_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/figures&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_figure_plot_losses_keras_file&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_files_base_name&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_folder&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_history_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_history.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_idx_h5_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_idx.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_log_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy.log&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_predictions_h5_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_predictions.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_scalers_pickle_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_scalers.pickle&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_summary_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_summary.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tensorboard_log_dir&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_graph_pdf_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_model_graph.pdf&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_h5_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_model.h5&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_json_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_model.json&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;output_tf_model_onnx_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_model.onnx&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;pars_bounds&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([[</span> <span class="o">-</span><span class="mf">5.</span><span class="p">,</span>   <span class="mf">5.</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">],</span>
           <span class="p">[</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span>  <span class="n">inf</span><span class="p">]])]</span>
    <span class="p">[</span><span class="s1">&#39;pars_central&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
    <span class="p">[</span><span class="s1">&#39;pars_labels&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$/theta_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{3}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{5}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{6}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{7}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{8}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{9}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;pars_labels_auto&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$/theta_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{1}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{2}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{3}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{4}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{5}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{6}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{7}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{8}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{9}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="s1">&#39;$/nu_</span><span class="si">{10}</span><span class="s1">$&#39;</span><span class="p">]]</span>
    <span class="p">[</span><span class="s1">&#39;pars_pos_nuis&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])]</span>
    <span class="p">[</span><span class="s1">&#39;pars_pos_poi&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])]</span>
    <span class="p">[</span><span class="s1">&#39;predictions&#39;</span><span class="p">,</span> <span class="p">{}]</span>
    <span class="p">[</span><span class="s1">&#39;same_data&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerX&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerX_bool&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerY&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;scalerY_bool&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;script_file&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;abs_path_to_output_folder&gt;/DNNLikelihood_toy_script.py&#39;</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;standalone&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;verbose&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;weighted&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="p">[</span><span class="s1">&#39;W_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;X_test&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;X_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;X_val&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;Y_test&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;Y_train&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;Y_val&#39;</span><span class="p">,</span> <span class="n">array</span><span class="p">([],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float64</span><span class="p">)]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_callbacks_inputs&#39;</span><span class="p">,</span> <span class="p">[{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;EarlyStopping&#39;</span><span class="p">,</span> <span class="s1">&#39;monitor&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;patience&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;min_delta&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="s1">&#39;restore_best_weights&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span> <span class="s1">&#39;TerminateOnNaN&#39;</span><span class="p">,</span> <span class="s1">&#39;PlotLossesKeras&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ReduceLROnPlateau&#39;</span><span class="p">,</span> <span class="s1">&#39;monitor&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;factor&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;min_lr&#39;</span><span class="p">:</span> <span class="mf">8e-05</span><span class="p">,</span> <span class="s1">&#39;patience&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;min_delta&#39;</span><span class="p">:</span> <span class="mf">0.0001</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ModelCheckpoint&#39;</span><span class="p">,</span> <span class="s1">&#39;filepath&#39;</span><span class="p">:</span> <span class="s1">&#39;automatically set by the framework&#39;</span><span class="p">,</span> <span class="s1">&#39;monitor&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="s1">&#39;mode&#39;</span><span class="p">:</span> <span class="s1">&#39;min&#39;</span><span class="p">,</span> <span class="s1">&#39;save_best_only&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;save_freq&#39;</span><span class="p">:</span> <span class="s1">&#39;epoch&#39;</span><span class="p">}]]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_compile_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="s1">&#39;metrics&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;msle&#39;</span><span class="p">,</span> <span class="s1">&#39;me&#39;</span><span class="p">]}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_data_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;npoints&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span> <span class="s1">&#39;scalerX&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;scalerY&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;weighted&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;scaleX&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;scaleY&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_define_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden_layers&#39;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;selu&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;selu&#39;</span><span class="p">,</span> <span class="s1">&#39;lecun_normal&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">]],</span> <span class="s1">&#39;act_func_out_layer&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;dropout_rate&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;batch_norm&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_optimizer_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Adam&#39;</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;beta_1&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;beta_2&#39;</span><span class="p">:</span> <span class="mf">0.999</span><span class="p">,</span> <span class="s1">&#39;amsgrad&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__model_train_inputs&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;epochs&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="s1">&#39;batch_size&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">}]</span>
    <span class="p">[</span><span class="s1">&#39;_DnnLik__resources_inputs&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</pre></div>
</div>
<p>Notice that the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.__init__" title="DNNLikelihood.DnnLik.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.__init__</span></code></a> method initializes
all attributes, leaving empty (with the correct type), all those arguments that will be populated during the object usage.
As it can be seen from the output of the object creation code, the object is saved upon creation. In case old files exist in the
specified path, they (the old ones) are renamed by appending a timestamp to them.</p>
<p>Once the <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is created, the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_build" title="DNNLikelihood.DnnLik.model_build"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_build</span></code></a>
method is used to create the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"  target="_blank"> tf.keras.Model</a> and compile it on the available resources as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">model_build</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">gpu</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">Building</span> <span class="n">tf</span> <span class="n">model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">on</span> <span class="n">device</span> <span class="p">[</span><span class="s1">&#39;/device:GPU:0&#39;</span><span class="p">,</span> <span class="s1">&#39;device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:3b:00.0, compute capability: 7.5&#39;</span><span class="p">]</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.001084800000000996</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">defined</span> <span class="ow">in</span> <span class="mf">0.8613295000000107</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Model</span><span class="p">:</span> <span class="s2">&quot;functional_1&quot;</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">Layer</span> <span class="p">(</span><span class="nb">type</span><span class="p">)</span>                 <span class="n">Output</span> <span class="n">Shape</span>              <span class="n">Param</span> <span class="c1">#</span>
    <span class="o">=================================================================</span>
    <span class="n">input_1</span> <span class="p">(</span><span class="n">InputLayer</span><span class="p">)</span>         <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>              <span class="mi">0</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>                <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">3600</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">batch_normalization_1</span> <span class="p">(</span><span class="n">Batch</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">1200</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_1</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">90300</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">batch_normalization_2</span> <span class="p">(</span><span class="n">Batch</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">1200</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_2</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">90300</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_3</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">90300</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">batch_normalization_3</span> <span class="p">(</span><span class="n">Batch</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">1200</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_4</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">90300</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">batch_normalization_4</span> <span class="p">(</span><span class="n">Batch</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>               <span class="mi">1200</span>
    <span class="n">_________________________________________________________________</span>
    <span class="n">dense_5</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>                 <span class="mi">301</span>
    <span class="o">=================================================================</span>
    <span class="n">Total</span> <span class="n">params</span><span class="p">:</span> <span class="mi">369</span><span class="p">,</span><span class="mi">901</span>
    <span class="n">Trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">367</span><span class="p">,</span><span class="mi">501</span>
    <span class="n">Non</span><span class="o">-</span><span class="n">trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span><span class="mi">400</span>
    <span class="n">_________________________________________________________________</span>
    <span class="kc">None</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.0009322000000224762</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">compiled</span> <span class="ow">in</span> <span class="mf">0.01071439999998347</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.0013625999999931082</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>This method uses the methods <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_define" title="DNNLikelihood.DnnLik.model_define"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_define</span></code></a> and
<a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_compile" title="DNNLikelihood.DnnLik.model_compile"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_compile</span></code></a> and implements the <a href="https://www.tensorflow.org/api_docs/python/tf/distribute/OneDeviceStrategy"  target="_blank"> tf.distribute.OneDeviceStrategy</a> strategy to
place the compiled model on a specified (e.g. <code class="docutils literal notranslate"><span class="pre">gpu=1</span></code>) or unspecified (i.e. <code class="docutils literal notranslate"><span class="pre">gpu=&quot;auto&quot;</span></code>) device. The <code class="docutils literal notranslate"><span class="pre">force</span></code> argument determines
if the model is re-generated and/or re-compiled even if already available, while the <code class="docutils literal notranslate"><span class="pre">verbose=2</span></code> ensures that all <code class="docutils literal notranslate"><span class="pre">print</span></code> commands
from each of the methods called within the method are active. The method sets, among others, the
<a class="reference internal" href="attributes.html#DNNLikelihood.DnnLik.model" title="DNNLikelihood.DnnLik.model"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DnnLik.model</span></code></a> attribute, which is the principal object containing the <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"  target="_blank"> tf.keras.Model</a>.</p>
<p>The DNNLikelihood is now ready to be trained. This can be done with the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_train" title="DNNLikelihood.DnnLik.model_train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_train</span></code></a>
method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">model_train</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="o">&lt;</span><span class="n">image</span><span class="o">&gt;</span>

    <span class="n">Loss</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.011</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">1.135</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.014</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.016</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">7.097</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.021</span><span class="p">)</span>
    <span class="n">mean_absolute_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.081</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.762</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.091</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.091</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">2.580</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.104</span><span class="p">)</span>
    <span class="n">mean_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.020</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.053</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.032</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.004</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">2.578</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.008</span><span class="p">)</span>
    <span class="n">mean_squared_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.011</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">1.135</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.014</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.016</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">7.097</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.021</span><span class="p">)</span>
    <span class="n">mean_squared_logarithmic_error</span>
            <span class="n">training</span>                 <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.002</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.114</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.002</span><span class="p">)</span>
            <span class="n">validation</span>               <span class="p">(</span><span class="nb">min</span><span class="p">:</span>    <span class="mf">0.002</span><span class="p">,</span> <span class="nb">max</span><span class="p">:</span>    <span class="mf">0.185</span><span class="p">,</span> <span class="n">cur</span><span class="p">:</span>    <span class="mf">0.003</span><span class="p">)</span>
    <span class="mi">20</span><span class="o">/</span><span class="mi">20</span> <span class="o">-</span> <span class="mi">1</span><span class="n">s</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">0.0137</span> <span class="o">-</span> <span class="n">mean_squared_error</span><span class="p">:</span> <span class="mf">0.0137</span> <span class="o">-</span> <span class="n">mean_absolute_error</span><span class="p">:</span> <span class="mf">0.0907</span> <span class="o">-</span> <span class="n">mean_squared_logarithmic_error</span><span class="p">:</span> <span class="mf">0.0023</span> <span class="o">-</span> <span class="n">mean_error</span><span class="p">:</span> <span class="mf">0.0324</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mf">0.0206</span> <span class="o">-</span> <span class="n">val_mean_squared_error</span><span class="p">:</span> <span class="mf">0.0206</span> <span class="o">-</span> <span class="n">val_mean_absolute_error</span><span class="p">:</span> <span class="mf">0.1043</span> <span class="o">-</span> <span class="n">val_mean_squared_logarithmic_error</span><span class="p">:</span> <span class="mf">0.0027</span> <span class="o">-</span> <span class="n">val_mean_error</span><span class="p">:</span> <span class="mf">0.0082</span>
    <span class="n">no</span> <span class="n">existing</span> <span class="n">history</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.001417500000002292</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Model</span> <span class="k">for</span> <span class="n">DNNLikelihood</span> <span class="n">DNNLikelihood_toy</span> <span class="n">successfully</span> <span class="n">trained</span> <span class="k">for</span> <span class="mi">300</span> <span class="n">epochs</span> <span class="ow">in</span> <span class="mf">1.1328149126666665</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>where &lt;image&gt; shows the training in real time whose final result is:</p>
<a class="with-shadow reference internal image-reference" href="../_images/plotlosseskeras.png"><img alt="../_images/plotlosseskeras.png" class="with-shadow" src="../_images/plotlosseskeras.png" style="width: 720.0px; height: 953.4px;" /></a>
<p>In this example we have used the <code class="docutils literal notranslate"><span class="pre">PlotLossesKeras</span></code> callback from <a href="https://github.com/stared/livelossplot/"  target="_blank"> livelossplot</a> to plot the metrics in real time
during training. Notice that this may be useful for quick checks, but it slows down training and is not optimal for long trainings.
Since no data were available yet when the method was called, training and validation data generation is done automatically.
The user may want to generate data in advance, which can be done as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">generate_train_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">generate_test_data</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_input_data_file</span><span class="o">&gt;.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.00331639999999922</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Added</span> <span class="mi">10000</span> <span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span> <span class="n">samples</span> <span class="ow">and</span> <span class="mi">3000</span> <span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">Y_val</span><span class="p">)</span> <span class="n">samples</span> <span class="ow">in</span> <span class="mf">14.896276299999998</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_input_data_file</span><span class="o">&gt;.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.003176200000002183</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Standard</span> <span class="n">scalers</span> <span class="n">defined</span> <span class="ow">in</span> <span class="mf">0.0030892000000015685</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.001671200000000539</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Data</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_input_data_file</span><span class="o">&gt;.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.0031719999999992865</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Added</span> <span class="mi">5000</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span> <span class="n">samples</span> <span class="ow">in</span> <span class="mf">0.07339520000000022</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.0009379000000002691</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>Data generation is taken care by the <a class="reference internal" href="attributes.html#DNNLikelihood.DnnLik.data" title="DNNLikelihood.DnnLik.data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DnnLik.data</span></code></a> attribute, which is a
<a class="reference internal" href="../data/class.html#DNNLikelihood.Data" title="DNNLikelihood.Data"><code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code></a> object (see <a class="reference internal" href="../data/index.html#module-data" title="data"><code class="xref py py-mod docutils literal notranslate"><span class="pre">the</span> <span class="pre">Data</span> <span class="pre">object</span></code></a> documentation for more details on data management).</p>
<p>The <a class="reference internal" href="class.html#DNNLikelihood.DnnLik" title="DNNLikelihood.DnnLik"><code class="xref py py-class docutils literal notranslate"><span class="pre">DnnLik</span></code></a> object is saved automatically after performing operations with its methods.
However, the user can also save it at any time with the commands:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">tf</span> <span class="n">executing</span> <span class="n">eager_mode</span><span class="p">:</span> <span class="kc">True</span>
    <span class="n">tf</span><span class="o">.</span><span class="n">keras</span> <span class="n">model</span> <span class="n">eager_mode</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">WARN</span><span class="p">:</span> <span class="n">No</span> <span class="n">corresponding</span> <span class="n">ONNX</span> <span class="n">op</span> <span class="n">matches</span> <span class="n">the</span> <span class="n">tf</span><span class="o">.</span><span class="n">op</span> <span class="n">node</span> <span class="n">keras_learning_phase</span> <span class="n">of</span> <span class="nb">type</span> <span class="n">PlaceholderWithDefault</span>
          <span class="n">The</span> <span class="n">generated</span> <span class="n">ONNX</span> <span class="n">model</span> <span class="n">needs</span> <span class="n">run</span> <span class="k">with</span> <span class="n">the</span> <span class="n">custom</span> <span class="n">op</span> <span class="n">supports</span><span class="o">.</span>
    <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_idx</span><span class="o">.</span><span class="n">h5</span> <span class="n">created</span> <span class="ow">and</span> <span class="n">saved</span> <span class="ow">in</span> <span class="mf">0.0037636999995811493</span> <span class="n">s</span><span class="o">.</span>
    <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_model</span><span class="o">.</span><span class="n">json</span> <span class="n">created</span> <span class="ow">and</span> <span class="n">saved</span><span class="o">.</span> <span class="mf">0.005548800000724441</span> <span class="n">s</span><span class="o">.</span>
    <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_model</span><span class="o">.</span><span class="n">h5</span> <span class="n">created</span> <span class="ow">and</span> <span class="n">saved</span><span class="o">.</span> <span class="mf">0.04865059999974619</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">Model</span> <span class="ow">not</span> <span class="n">defined</span><span class="o">.</span> <span class="n">No</span> <span class="n">file</span> <span class="ow">is</span> <span class="n">saved</span><span class="o">.</span>
    <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_history</span><span class="o">.</span><span class="n">json</span> <span class="n">created</span> <span class="ow">and</span> <span class="n">saved</span><span class="o">.</span> <span class="mf">0.000771300000451447</span> <span class="n">s</span><span class="o">.</span>
    <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_predictions</span><span class="o">.</span><span class="n">h5</span> <span class="n">created</span> <span class="ow">and</span> <span class="n">saved</span><span class="o">.</span> <span class="mf">0.0030419000004258123</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">json</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_summary</span><span class="o">.</span><span class="n">json</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.002336999999897671</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">scalers</span> <span class="n">pickle</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_scalers</span><span class="o">.</span><span class="n">pickle</span> <span class="n">saved</span> <span class="ow">in</span> <span class="mf">0.0011084999996455736</span> <span class="n">s</span><span class="o">.</span>
    <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy_model_graph</span><span class="o">.</span><span class="n">pdf</span>  <span class="n">created</span> <span class="ow">and</span> <span class="n">saved</span> <span class="ow">in</span> <span class="mf">1.8243855999999141</span> <span class="n">s</span><span class="o">.</span>
    <span class="n">DnnLik</span> <span class="n">log</span> <span class="n">file</span> <span class="o">&lt;</span><span class="n">abs_path_to_output_folder</span><span class="o">&gt;</span>\<span class="n">DNNLikelihood_toy</span><span class="o">.</span><span class="n">log</span> <span class="n">updated</span> <span class="ow">in</span> <span class="mf">0.0019879000001310487</span> <span class="n">s</span><span class="o">.</span>
</pre></div>
</div>
<p>Now that the DNNLikelihood is built and trained, one can pass to evaluate its performances. There are several methods to compute
metrics and make plots, whose extensive guide is available in the <a class="reference internal" href="methods.html#dnnlik-methods"><span class="std std-ref">methods documentation</span></a>. The framework also
includes the <a class="reference internal" href="methods.html#DNNLikelihood.DnnLik.model_compute_predictions" title="DNNLikelihood.DnnLik.model_compute_predictions"><code class="xref py py-meth docutils literal notranslate"><span class="pre">DnnLik.model_compute_predictions</span></code></a> method,
devoted to a comprehensive evaluation of the model performances. It can be used as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dnnlikelihood</span><span class="o">.</span><span class="n">model_compute_predictions</span><span class="p">(</span><span class="n">CI</span><span class="o">=</span><span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">CI_from_sigma</span><span class="p">([</span><span class="n">DNNLikelihood</span><span class="o">.</span><span class="n">inference</span><span class="o">.</span><span class="n">sigma_from_CI</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
                                        <span class="n">pars</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
                                        <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                        <span class="n">model_predict_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;x_boundaries&quot;</span><span class="p">:</span> <span class="s2">&quot;original&quot;</span><span class="p">,</span>
                                                                <span class="s2">&quot;y_boundaries&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                                                                <span class="s2">&quot;save_log&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
                                        <span class="n">HPDI_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;nbins&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span>
                                                       <span class="s2">&quot;print_hist&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                                                       <span class="s2">&quot;optimize_binning&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                        <span class="n">plot_training_history_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;metrics&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="s2">&quot;me&quot;</span><span class="p">],</span>
                                                                        <span class="s2">&quot;yscale&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
                                                                        <span class="s2">&quot;show_plot&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                        <span class="n">plot_pars_coverage_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loglik&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                                                                     <span class="s2">&quot;show_plot&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                        <span class="n">plot_lik_distribution_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loglik&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                                                                        <span class="s2">&quot;show_plot&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                        <span class="n">plot_corners_2samp_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ranges_extend&quot;</span><span class="p">:</span> <span class="mf">1.3</span><span class="p">,</span>
                                                                     <span class="s2">&quot;max_points&quot;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                                                                     <span class="s2">&quot;nbins&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
                                                                     <span class="s2">&quot;show_plot&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
                                        <span class="n">frequentist_inference</span> <span class="o">=</span> <span class="p">{},</span>
                                        <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="class.html" class="btn btn-neutral float-right" title="Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="The DNNLikelihood object" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Andrea Coccaro; Maurizio Pierini; Luca Silvestrini; Riccardo Torre

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>